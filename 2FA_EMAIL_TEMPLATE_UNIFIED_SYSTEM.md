# ๐ ูุธุงู ุงูุชููุจููุช ุงูููุญุฏ ูุฑูุฒ ุงูุชุญูู ุงูุซูุงุฆู - ุฑุฒูู

**ุงูุชุงุฑูุฎ:** 15 ุณุจุชูุจุฑ 2025  
**ุงูููุช:** 05:17 ุตุจุงุญุงู (ุชูููุช ุงูุณุนูุฏูุฉ)  
**ุงูุญุงูุฉ:** โ ุชู ุงูุชุทุจูู ูุงูุชูุญูุฏ

---

## ๐ฏ ุงููุดููุฉ ุงูุชู ุชู ุญููุง

- **ุงูุชููุจููุช ุงููุฏูู:** ูุงู ูุณุชุฎุฏู HTML ููุชูุจ ูุฏููุงู ุจุฏูู ูุธุงู ููุญุฏ
- **ูุดุงูู ุงูุงุชุฌุงู:** ุนุฏู ุถุจุท RTL/LTR ุจุดูู ุตุญูุญ
- **ุนุฏู ุงูุชูุญูุฏ:** ูู ููุน ุฅูููู ูู ุชููุจููุช ูููุตู
- **ุนุฏู ุฏุนู ุงููุบุชูู:** ูุญุชูู ุนุฑุจู ููุท ุจุฏูู ุฅูุฌููุฒูุฉ

---

## โ ุงูุญู ุงููุทุจู

### ๐ **ุงูุชุญุฏูุซ ูู `userTwoFactorService.ts`:**

```typescript
// ูุจู ุงูุชุญุฏูุซ - HTML ููุชูุจ ูุฏููุงู
subject = 'ููุฏ ุชุณุฌูู ุงูุฏุฎูู - ุฑุฒูู';
message = `
  <div dir="rtl" style="font-family: Arial, sans-serif;">
    <!-- HTML ููุชูุจ ูุฏููุงู ุจุฏูู ูุธุงู ููุญุฏ -->
  </div>
`;

// ุจุนุฏ ุงูุชุญุฏูุซ - ุงููุธุงู ุงูููุญุฏ
const { AdvancedEmailService } = await import('./finalEmailServiceNew');

emailTemplate = AdvancedEmailService.generateEmailTemplate(
  '2fa_code',
  { 
    code: code,
    recipientName: 'ุงููุณุชุฎุฏู',
    validityMinutes: 10
  },
  language // 'ar' ุฃู 'en'
);
```

### ๐จ **ุงููููุฒุงุช ุงูุฌุฏูุฏุฉ:**

1. **ุงููุธุงู ุงูููุญุฏ:**
   - ุงุณุชุฎุฏุงู `AdvancedEmailService.generateEmailTemplate()`
   - ุชููุจููุช ููุญุฏ ูุฌููุน ุฃููุงุน ุฑููุฒ ุงูุชุญูู
   - ูุธุงู ุฅุฑุณุงู ููุญุฏ ุนุจุฑ `RealEmailService`

2. **ุฏุนู ุงููุบุชูู:**
   ```typescript
   // ุงูุนุฑุจูุฉ
   language: 'ar' โ RTL + ุฎุท Tahoma + ูุญุชูู ุนุฑุจู
   
   // ุงูุฅูุฌููุฒูุฉ  
   language: 'en' โ LTR + ุฎุท Arial + ูุญุชูู ุฅูุฌููุฒู
   ```

3. **ุฃููุงุน ุงูุชููุจููุช ุงููุฏุนููุฉ:**
   - `'2fa_code'` - ุฑูุฒ ุงูุชุญูู ุงูุซูุงุฆู ุงูุนุงุฏู
   - `'security_2fa'` - ุฑูุฒ ุฃูุงู ุงูุฅุนุฏุงุฏุงุช
   - ุชููุจููุช ููุญุฏ ูุน ูุญุชูู ูุฎุตุต ููู ููุน

---

## ๐ง ุงูุชููุจููุช ุงูุฌุฏูุฏ

### **ุฑูุฒ ุงูุชุญูู ุงูุซูุงุฆู (2FA Code):**

**ุงูุนุฑุจูุฉ:**
```
ุงูููุถูุน: ุฑูุฒ ุงูุชุญูู ุงูุซูุงุฆู - ุฑุฒูู
ุงููุญุชูู: 
- ุชุฑุญูุจ: "ุงูุณูุงู ุนูููู ุงููุณุชุฎุฏู"
- ูุตู: "ุชู ุทูุจ ุฑูุฒ ุชุญูู ูุชุณุฌูู ุงูุฏุฎูู"
- ุงูุฑูุฒ: ุนุฑุถ ุจุงุฑุฒ ูุน ุชูุณูู ุฎุงุต
- ุตุงูุญ ูู: 10 ุฏูุงุฆู
- ุชุญุฐูุฑ ุฃููู: ุนุฏู ุงููุดุงุฑูุฉ
- ุงุชุฌุงู: RTL
- ุฎุท: Tahoma
```

**ุงูุฅูุฌููุฒูุฉ:**
```
Subject: Two-Factor Authentication Code - Rezge
Content:
- Greeting: "Hello User"
- Description: "A verification code was requested for login"
- Code: Prominently displayed with special formatting
- Valid for: 10 minutes
- Security warning: Do not share
- Direction: LTR
- Font: Arial
```

---

## ๐ง ุฃููุงุน ุงูุนูููุงุช ุงููุฏุนููุฉ

| ุงูููุน | ุงูุชููุจููุช ุงููุณุชุฎุฏู | ุงููุตู |
|-------|------------------|-------|
| **`login`** | `2fa_code` | ุฑูุฒ ุชุณุฌูู ุงูุฏุฎูู |
| **`device_trust`** | `2fa_code` | ุฑูุฒ ุงูุชุญูู ูู ุงูุฌูุงุฒ |
| **`password_reset`** | `security_2fa` | ุฑูุฒ ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ |

---

## ๐จ ุงูุชุตููู ุงูููุญุฏ

### **ุงููููุฒุงุช ุงูุจุตุฑูุฉ:**
- ๐จ ุชุฏุฑุฌ ูููู ุฌุฐุงุจ (ุฃุฒุฑู ุฅูู ุฃุฎุถุฑ)
- ๐ฑ ุชุตููู ูุชุฌุงูุจ ูุฌููุน ุงูุฃุฌูุฒุฉ
- ๐ค ุนุฑุถ ุงูุฑูุฒ ุจุฎุท Monospace ูุน ุชุจุงุนุฏ ุฃุญุฑู
- โ๏ธ ุชุญุฐูุฑุงุช ุฃูููุฉ ุจุฃููุงู ูููุฒุฉ
- ๐ท๏ธ ุดุนุงุฑ ููููุฉ ููุญุฏุฉ

### **ุงูุงุชุฌุงู ูุงูุฎุทูุท:**
```css
/* ุงูุนุฑุจูุฉ */
direction: rtl;
font-family: Tahoma, Arial, sans-serif;
text-align: right;

/* ุงูุฅูุฌููุฒูุฉ */
direction: ltr;
font-family: Arial, Helvetica, sans-serif;
text-align: left;
```

---

## ๐ ุทุฑููุฉ ุงูุงุณุชุฎุฏุงู

### **ูู ุงูููุฏ:**
```typescript
// ุฅุฑุณุงู ุฑูุฒ ุชุญูู ุซูุงุฆู
await userTwoFactorService.sendVerificationCode(
  userId,
  email,
  'login' // ุฃู 'device_trust' ุฃู 'password_reset'
);

// ุณูุชู ุชููุงุฆูุงู:
// 1. ุฅูุดุงุก ุงูุชููุจููุช ุงูููุงุณุจ
// 2. ุถุจุท ุงูุงุชุฌุงู ูุงููุบุฉ
// 3. ุฅุฑุณุงู ุงูุฅูููู ุนุจุฑ ุงููุธุงู ุงูููุญุฏ
```

### **ูู ุตูุญุฉ ุงูุชุญูู ุงูุซูุงุฆู:**
```typescript
// TwoFactorVerificationPage.tsx
const result = await twoFactorService.sendVerificationCode(
  userId,
  email,
  codeType // 'login' | 'enable_2fa' | 'disable_2fa'
);
```

---

## ๐ ุงููููุงุช ุงููุญุฏุซุฉ

1. **`src/lib/userTwoFactorService.ts`** - ุงููุธุงู ุงูููุญุฏ ููุชุญูู ุงูุซูุงุฆู
2. **`src/lib/finalEmailServiceNew.ts`** - ุงูุชููุจููุช ุงููุชูุฏู
3. **`src/lib/realEmailService.ts`** - ูุธุงู ุงูุฅุฑุณุงู ุงูููุญุฏ
4. **`2FA_EMAIL_TEMPLATE_UNIFIED_SYSTEM.md`** - ูุฐุง ุงูุชูุซูู

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### **ูุงุฎุชุจุงุฑ ุงููุธุงู:**
```typescript
// ุงุฎุชุจุงุฑ ุฅุฑุณุงู ุฑูุฒ ุชุญูู
const result = await userTwoFactorService.sendVerificationCode(
  'user-id',
  'user@example.com',
  'login'
);

console.log('Result:', result);
// Expected: { success: true, requiresVerification: true, verificationSent: true }
```

### **ุงูุชุญูู ูู ุงูุชููุจููุช:**
```typescript
// ุนุฑุถ ุงูุชููุจููุช
const template = AdvancedEmailService.generateEmailTemplate(
  '2fa_code',
  { 
    code: '123456',
    recipientName: 'ุฃุญูุฏ ูุญูุฏ',
    validityMinutes: 10
  },
  'ar'
);

console.log('Subject:', template.subject);
console.log('HTML:', template.htmlContent);
console.log('Text:', template.textContent);
```

---

## โ ุงููุชุงุฆุฌ

- **โ ุชููุจููุช ููุญุฏ** ูุฌููุน ุฃููุงุน ุฑููุฒ ุงูุชุญูู
- **โ ุงุชุฌุงู ูุถุจูุท** RTL ููุนุฑุจูุฉุ LTR ููุฅูุฌููุฒูุฉ  
- **โ ุฏุนู ุงููุบุชูู** ูุญุชูู ูุงูู ุจุงูุนุฑุจูุฉ ูุงูุฅูุฌููุฒูุฉ
- **โ ุชุตููู ูุญุณู** ุฃููุงู ูุชูุณูู ุงุญุชุฑุงูู
- **โ ูุธุงู ุฅุฑุณุงู ููุญุฏ** ูุน fallback ูุชุนุฏุฏ ุงูุทุฑู
- **โ ุฃูุงู ูุญุณู** ุชุญุฐูุฑุงุช ูุงุถุญุฉ ูุชูููุชุงุช ูุญุฏุฏุฉ

---

**ยฉ 2025 ุฑุฒูู - ูููุน ุงูุฒูุงุฌ ุงูุฅุณูุงูู ุงูุดุฑุนู**  
**ุชู ุงูุชุทููุฑ ูุงูุชุญุณูู ุจูุงุณุทุฉ:** Cascade AI Assistant
