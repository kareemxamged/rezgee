# ุฏููู ุฅุนุฏุงุฏ ูุธุงู ุงูุญุธุฑ ุงูุดุงูู
## Enhanced Block System Setup Guide

ูุฐุง ุงูุฏููู ููุถุญ ููููุฉ ุฅุนุฏุงุฏ ูุชุดุบูู ูุธุงู ุงูุญุธุฑ ุงูุดุงูู ุงููุทูุฑ ูู ูููุน ุฑุฒูู.

## ๐ ุงููุชุทูุจุงุช ุงูุฃุณุงุณูุฉ

### 1. ูุงุนุฏุฉ ุงูุจูุงูุงุช
ูุชุทูุจ ุงููุธุงู ุฅูุดุงุก ุฌุฏูู `user_blocks` ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช Supabase:

```sql
-- ุชุดุบูู ุงูููู ุงูุชุงูู ูู Supabase SQL Editor
supabase/migrations/create_user_blocks_table.sql
```

### 2. ุงููููุงุช ุงููุทููุจุฉ
ุชุฃูุฏ ูู ูุฌูุฏ ุงููููุงุช ุงูุชุงููุฉ ูุน ุงูุชุญุฏูุซุงุช ุงูุฌุฏูุฏุฉ:
- `src/components/MessagesPage.tsx` - ุตูุญุฉ ุงูุฑุณุงุฆู ุงููุญุฏุซุฉ
- `src/lib/supabase.ts` - ุฎุฏูุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุญุฏุซุฉ
- `src/components/ConfirmModal.tsx` - ููุงูุฐ ุงูุชุฃููุฏ

## ๐ ุฎุทูุงุช ุงูุฅุนุฏุงุฏ

### ุงูุฎุทูุฉ 1: ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช
1. ุงูุชุญ Supabase Dashboard
2. ุงูุชูู ุฅูู SQL Editor
3. ุงูุณุฎ ูุญุชูู ููู `supabase/migrations/create_user_blocks_table.sql`
4. ุดุบู ุงูุงุณุชุนูุงู ูุฅูุดุงุก ุงูุฌุฏูู ูุงูุฏูุงู ุงููุทููุจุฉ

### ุงูุฎุทูุฉ 2: ุงูุชุญูู ูู ุงูุฅุนุฏุงุฏ
```sql
-- ุชุญูู ูู ุฅูุดุงุก ุงูุฌุฏูู
SELECT * FROM user_blocks LIMIT 1;

-- ุชุญูู ูู ุงูุฏูุงู
SELECT is_user_blocked('uuid1', 'uuid2');
SELECT * FROM get_blocked_users('uuid1');
```

### ุงูุฎุทูุฉ 3: ุงุฎุชุจุงุฑ ุงููุธุงู
1. ุงูุชุญ ููู `test-enhanced-block-system.html` ูู ุงููุชุตูุญ
2. ุงุชุจุน ุฎุทูุงุช ุงูุงุฎุชุจุงุฑ ุงูููุตูุฉ
3. ุชุฃูุฏ ูู ุนูู ุฌููุน ุงูููุฒุงุช ุจุดูู ุตุญูุญ

## ๐ง ุงูููุฒุงุช ุงููุชุงุญุฉ

### 1. ุญุธุฑ ุงููุณุชุฎุฏู
- ุงููุฑ ุนูู ูุงุฆูุฉ ุงูุซูุงุซ ููุงุท ูู ุงููุญุงุฏุซุฉ
- ุงุฎุชุฑ "ุญุธุฑ ุงููุณุชุฎุฏู"
- ุงูุฑุฃ ุฑุณุงูุฉ ุงูุชุฃููุฏ ูุงุถุบุท "ุญุธุฑ ุงููุณุชุฎุฏู ููุงุฆูุงู"

### 2. ุฅูุบุงุก ุญุธุฑ ุงููุณุชุฎุฏู
- ูู ุงููุญุงุฏุซุฉ ุงููุญุธูุฑุฉุ ุงููุฑ ุนูู ูุงุฆูุฉ ุงูุซูุงุซ ููุงุท
- ุงุฎุชุฑ "ุฅูุบุงุก ุญุธุฑ ุงููุณุชุฎุฏู"
- ุงูุฑุฃ ุฑุณุงูุฉ ุงูุชุฃููุฏ ูุงุถุบุท "ุฅูุบุงุก ุงูุญุธุฑ"

### 3. ููุชุฑุฉ ุงูุจุญุซ
- ุงููุณุชุฎุฏููู ุงููุญุธูุฑูู ูุง ูุธูุฑูู ูู ูุชุงุฆุฌ ุงูุจุญุซ ุชููุงุฆูุงู
- ุงูููุชุฑุฉ ุชุนูู ูู ุงูุงุชุฌุงููู (ุงููุญุธูุฑ ูุง ูุฑู ุงูุญุงุธุฑ ูุงูุนูุณ)

## ๐ ูุฑุงูุจุฉ ุงููุธุงู

### ุงุณุชุนูุงูุงุช ูููุฏุฉ ูููุฑุงูุจุฉ:
```sql
-- ุนุฏุฏ ุงููุณุชุฎุฏููู ุงููุญุธูุฑูู
SELECT COUNT(*) FROM user_blocks WHERE status = 'active';

-- ุฃูุซุฑ ุงููุณุชุฎุฏููู ุญุธุฑุงู ููุขุฎุฑูู
SELECT blocker_id, COUNT(*) as blocks_count 
FROM user_blocks 
WHERE status = 'active' 
GROUP BY blocker_id 
ORDER BY blocks_count DESC;

-- ุงููุณุชุฎุฏููู ุงูุฃูุซุฑ ุชุนุฑุถุงู ููุญุธุฑ
SELECT blocked_user_id, COUNT(*) as blocked_count 
FROM user_blocks 
WHERE status = 'active' 
GROUP BY blocked_user_id 
ORDER BY blocked_count DESC;
```

## ๐๏ธ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ูุดููุฉ: ุงูุฌุฏูู ุบูุฑ ููุฌูุฏ
```
Error: relation "user_blocks" does not exist
```
**ุงูุญู:** ุชุฃูุฏ ูู ุชุดุบูู ููู `create_user_blocks_table.sql` ูู Supabase

### ูุดููุฉ: ุตูุงุญูุงุช ุบูุฑ ูุงููุฉ
```
Error: permission denied for table user_blocks
```
**ุงูุญู:** ุชุญูู ูู ุฅุนุฏุงุฏุงุช RLS ูู Supabase ูุชุฃูุฏ ูู ูุฌูุฏ ุงูุณูุงุณุงุช ุงูุตุญูุญุฉ

### ูุดููุฉ: ุงูุฎูุงุฑ ูุง ูุชุบูุฑ
ุฅุฐุง ูู ูุชุบูุฑ ุฎูุงุฑ "ุญุธุฑ ุงููุณุชุฎุฏู" ุฅูู "ุฅูุบุงุก ุญุธุฑ ุงููุณุชุฎุฏู":
1. ุชุญูู ูู ุญุงูุฉ ุงููุญุงุฏุซุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
2. ุชุฃูุฏ ูู ุชุญุฏูุซ `activeConversation.status` ูู ุงูููุฏ
3. ุฑุงุฌุน console ููุฃุฎุทุงุก

## ๐ ููุงุญุธุงุช ูููุฉ

### ุงูุฃูุงู
- ุฌููุน ุงูุนูููุงุช ุชุชุทูุจ ูุตุงุฏูุฉ ุงููุณุชุฎุฏู
- RLS ููุนู ุนูู ุฌุฏูู `user_blocks`
- ุงููุณุชุฎุฏู ููููู ููุท ุฅุฏุงุฑุฉ ุงูุญุธุฑ ุงูุฐู ูุงู ุจู

### ุงูุฃุฏุงุก
- ุงูุฌุฏูู ูููุฑุณ ููุงุณุชุนูุงูุงุช ุงูุณุฑูุนุฉ
- ููุชุฑุฉ ุงูุจุญุซ ูุญุณูุฉ ูุชุฌูุจ ุงูุชุฃุซูุฑ ุนูู ุงูุฃุฏุงุก
- ุงุณุชุฎุฏุงู ุฏูุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช ููุงุณุชุนูุงูุงุช ุงููุนูุฏุฉ

### ุงูุชูุงูู
- ุงููุธุงู ูุชูุงูู ูุน ุฌููุน ุงูููุฒุงุช ุงูููุฌูุฏุฉ
- ูุง ูุคุซุฑ ุนูู ุงููุญุงุฏุซุงุช ุงูููุฌูุฏุฉ
- ูููู ุชุนุทููู ุจุณูููุฉ ุฅุฐุง ูุฒู ุงูุฃูุฑ

## ๐ ุงูุชุญุฏูุซุงุช ุงููุณุชูุจููุฉ

### ููุฒุงุช ููุชุฑุญุฉ:
- ุฅุญุตุงุฆูุงุช ููุตูุฉ ููุญุธุฑ
- ุชูุงุฑูุฑ ุฅุฏุงุฑูุฉ ูููุณุชุฎุฏููู ุงููุญุธูุฑูู
- ุญุธุฑ ูุคูุช ุจูุฏุฉ ุฒูููุฉ ูุญุฏุฏุฉ
- ุฅุดุนุงุฑุงุช ููุฅุฏุงุฑุฉ ุนูุฏ ุงูุญุธุฑ ุงููุชูุฑุฑ

### ุชุญุณููุงุช ุชูููุฉ:
- ุชุญุณูู ุฃุฏุงุก ููุชุฑุฉ ุงูุจุญุซ
- ุฅุถุงูุฉ cache ููุงุณุชุนูุงูุงุช ุงููุชูุฑุฑุฉ
- ุชุญุณูู ูุงุฌูุฉ ุงููุณุชุฎุฏู ููุฃุฌูุฒุฉ ุงููุญูููุฉ

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู ูู ุงูุฅุนุฏุงุฏ ุฃู ุงูุชุดุบูู:
1. ุฑุงุฌุน ููู `test-enhanced-block-system.html` ููุงุฎุชุจุงุฑ
2. ุชุญูู ูู console ุงููุชุตูุญ ููุฃุฎุทุงุก
3. ุฑุงุฌุน logs ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู Supabase
4. ุชุฃูุฏ ูู ุชุญุฏูุซ ุฌููุน ุงููููุงุช ุงููุทููุจุฉ

## ๐ ูุคุดุฑุงุช ุงููุฌุงุญ

ุงููุธุงู ูุนูู ุจุดูู ุตุญูุญ ุฅุฐุง:
- โ ูููู ุญุธุฑ ุงููุณุชุฎุฏููู ุจูุฌุงุญ
- โ ูุชุบูุฑ ุงูุฎูุงุฑ ูู "ุญุธุฑ" ุฅูู "ุฅูุบุงุก ุญุธุฑ"
- โ ุงููุณุชุฎุฏููู ุงููุญุธูุฑูู ูุง ูุธูุฑูู ูู ุงูุจุญุซ
- โ ูููู ุฅูุบุงุก ุงูุญุธุฑ ุจูุฌุงุญ
- โ ุงูุฅุดุนุงุฑุงุช ุชุธูุฑ ุจุดูู ุตุญูุญ
- โ ูุง ุชูุฌุฏ ุฃุฎุทุงุก ูู console ุงููุชุตูุญ

---

**ุชู ุชุทููุฑ ูุฐุง ุงููุธุงู ูุฌุฒุก ูู ูุดุฑูุน ูููุน ุฑุฒูู ููุฒูุงุฌ ุงูุฅุณูุงูู ุงูุดุฑุนู**
**ุฌููุน ุงูููุฒุงุช ุชุชูุงูู ูุน ุงูุถูุงุจุท ุงูุดุฑุนูุฉ ูุชูุฏู ูุญูุงูุฉ ุงููุณุชุฎุฏููู**
