# ๐ง ุฅุตูุงุญ ุชุญููู ููู ูุณุชูู ุงูุชุฏูู ูู ุฎุฏูุฉ ุงูุชุญูู ูู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู

## ๐ ุชุงุฑูุฎ ุงูุฅุตูุงุญ: 16 ุณุจุชูุจุฑ 2025

## ๐ฏ ุงููุดููุฉ ุงููุญุฏุฏุฉ

ุฑุบู ุฅุตูุงุญ ูููุฐุฌ ุงูุชุณุฌููุ ูุงูุช ุงููุดููุฉ ูุง ุชุฒุงู ููุฌูุฏุฉ ูู ุตูุญุฉ "set-password" ุจุณุจุจ:
- ุงูุจูุงูุงุช ุงููุญููุธุฉ ูู `email_verifications` ุชุญุชูู ุนูู ุงูููู ุงููุฏููุฉ
- ุฎุฏูุฉ `EmailVerificationService` ูุง ุชุญูู ุงูููู ุนูุฏ ุฅูุดุงุก ุงูููู ุงูุดุฎุตู

## ๐ ุชุญููู ุงููุดููุฉ

### ุงูุณุจุจ ุงูุฌุฐุฑู:
1. **ุงูุจูุงูุงุช ุงููุญููุธุฉ ุณุงุจูุงู**: ุงููุณุชุฎุฏููู ุงูุฐูู ุณุฌููุง ูุจู ุงูุฅุตูุงุญ ูุฏููู `'somewhat_religious'` ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
2. **ุนุฏู ูุฌูุฏ ุชุญููู**: `emailVerification.ts` ูุงู ููุฑุฑ ุงูููู ูุจุงุดุฑุฉ ุฏูู ุชุญููู
3. **ุนุฏู ุชุทุงุจู ุงูููู**: ุงูููู ุงููุฏููุฉ ูุง ุชุทุงุจู ูููุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ

## โ ุงูุญู ุงููุทุจู

### 1. ุฅุถุงูุฉ ุฏุงูุฉ ุชุญููู ูุณุชูู ุงูุชุฏูู

```typescript
// ุฏุงูุฉ ูุชุญููู ููู ูุณุชูู ุงูุชุฏูู ูู ูููุฐุฌ ุงูุชุณุฌูู ุฅูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
private static mapReligiosityLevel(religiosityValue?: string): string | null {
  if (!religiosityValue) return null;

  // ุชุญููู ุงูููู ุงููุฏููุฉ ุฅูู ุงูููู ุงูุฌุฏูุฏุฉ ุงููุทุงุจูุฉ ููุงุนุฏุฉ ุงูุจูุงูุงุช
  switch (religiosityValue) {
    case 'somewhat_religious':
      return 'slightly_religious';
    case 'not_religious':
    case 'slightly_religious':
    case 'religious':
    case 'very_religious':
    case 'prefer_not_say':
      return religiosityValue; // ุงูููู ุตุญูุญุฉ ุจุงููุนู
    default:
      console.warn(`โ๏ธ Unknown religiosity level: ${religiosityValue}, setting to null`);
      return null;
  }
}
```

### 2. ุชุทุจูู ุงูุชุญููู ูู ุฅูุดุงุก ุงูููู ุงูุดุฎุตู

```typescript
// ุชุทุจูู ุชุญููู ุงูููู ููุชุฃูุฏ ูู ุงููุทุงุจูุฉ ูุน ูุงุนุฏุฉ ุงูุจูุงูุงุช
religiosity_level: EmailVerificationService.mapReligiosityLevel(verification.user_data.religiosity_level),
```

### 3. ุฅุถุงูุฉ ุชุณุฌูู ุชุดุฎูุตู

```typescript
// ุชุณุฌูู ุงูุจูุงูุงุช ุงููุงุฑุฏุฉ ููุชุดุฎูุต
console.log('๐ User data received:', verification.user_data);
console.log('๐ Religiosity level value:', verification.user_data.religiosity_level);
console.log('๐ค Profile data to be sent:', profileData);
```

## ๐ง ุงููููุงุช ุงููุญุฏุซุฉ

### ุงูููู ุงูุฑุฆูุณู:
- **`src/lib/emailVerification.ts`**: ุฅุถุงูุฉ ุฏุงูุฉ ุงูุชุญููู ูุชุทุจูููุง

### ุงูุชุบููุฑุงุช ุงููุญุฏุฏุฉ:
1. **ุฅุถุงูุฉ `mapReligiosityLevel()` method** - ุชุญููู ุงูููู ุงููุฏููุฉ ููุฌุฏูุฏุฉ
2. **ุชุทุจูู ุงูุชุญููู** ูู `createOrUpdateUserProfile()`
3. **ุฅุถุงูุฉ ุชุณุฌูู ุชุดุฎูุตู** ูุชุชุจุน ุงูููู
4. **ูุนุงูุฌุฉ ุงูููู ุบูุฑ ุงููุนุฑููุฉ** ุจุชุญููููุง ุฅูู `null`

## ๐ฏ ููู ุงูุชุญููู ุงููุฏุนููุฉ

### ุงูุชุญูููุงุช ุงููุทุจูุฉ:
- `'somewhat_religious'` โ `'slightly_religious'` โ
- `'not_religious'` โ `'not_religious'` โ
- `'slightly_religious'` โ `'slightly_religious'` โ
- `'religious'` โ `'religious'` โ
- `'very_religious'` โ `'very_religious'` โ
- `'prefer_not_say'` โ `'prefer_not_say'` โ
- ุฃู ูููุฉ ุฃุฎุฑู โ `null` โ๏ธ

## ๐ ููููุฉ ุงุฎุชุจุงุฑ ุงูุฅุตูุงุญ

### 1. ุงุฎุชุจุงุฑ ุงููุณุชุฎุฏููู ุงูุฌุฏุฏ:
1. ุณุฌู ุญุณุงุจ ุฌุฏูุฏ ูุน ุงุฎุชูุงุฑ ูุณุชูู ุงูุชุฏูู
2. ุงุณุชูู ุฅูููู ุงูุชุญูู
3. ุงููุฑ ุนูู ุฑุงุจุท ุงูุชุญูู
4. ุฃุฏุฎู ูููุฉ ุงููุฑูุฑ ูู ุตูุญุฉ set-password
5. ูุฌุจ ุฅููุงู ุงูุชุณุฌูู ุจูุฌุงุญ

### 2. ุงุฎุชุจุงุฑ ุงููุณุชุฎุฏููู ุงููุฏุงูู:
1. ุงุณุชุฎุฏู ุฑุงุจุท ุชุญูู ููุณุชุฎุฏู ุณุฌู ูุจู ุงูุฅุตูุงุญ
2. ุฃุฏุฎู ูููุฉ ุงููุฑูุฑ
3. ูุฌุจ ุชุญููู ุงูููู ุงููุฏููุฉ ุชููุงุฆูุงู

### 3. ูุฑุงูุจุฉ ุงููููุณูู:
ุงุจุญุซ ุนู ูุฐู ุงูุฑุณุงุฆู:
```
๐ User data received: {...}
๐ Religiosity level value: somewhat_religious
๐ค Profile data to be sent: {...religiosity_level: 'slightly_religious'...}
โ User profile created successfully
```

## ๐ ููุงุฑูุฉ ูุจู ูุจุนุฏ ุงูุฅุตูุงุญ

### โ ูุจู ุงูุฅุตูุงุญ:
```
emailVerification.ts โ 'somewhat_religious' โ Database Constraint Error
โ new row violates check constraint "check_religiosity_level"
```

### โ ุจุนุฏ ุงูุฅุตูุงุญ:
```
emailVerification.ts โ mapReligiosityLevel() โ 'slightly_religious' โ Database Accepts
โ User profile created successfully
```

## ๐ ุงูุญูุงูุฉ ูู ุงูุฃุฎุทุงุก

### 1. ูุนุงูุฌุฉ ุงูููู ุงููุงุฑุบุฉ:
```typescript
if (!religiosityValue) return null;
```

### 2. ูุนุงูุฌุฉ ุงูููู ุบูุฑ ุงููุนุฑููุฉ:
```typescript
default:
  console.warn(`โ๏ธ Unknown religiosity level: ${religiosityValue}, setting to null`);
  return null;
```

### 3. ุชุณุฌูู ุชุดุฎูุตู ุดุงูู:
- ุชุณุฌูู ุงูุจูุงูุงุช ุงููุงุฑุฏุฉ
- ุชุณุฌูู ุงูููู ูุจู ูุจุนุฏ ุงูุชุญููู
- ุชุณุฌูู ุงูุจูุงูุงุช ุงููุฑุณูุฉ ููุงุนุฏุฉ ุงูุจูุงูุงุช

## ๐ ููุงุญุธุงุช ูููุทูุฑูู

### 1. ุงูุชูุงูู ูุน ุงูุฅุตุฏุงุฑุงุช ุงูุณุงุจูุฉ:
- ุงูุฏุงูุฉ ุชุฏุนู ุงูููู ุงููุฏููุฉ ูุงูุฌุฏูุฏุฉ
- ูุง ุญุงุฌุฉ ูุชุญุฏูุซ ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ
- ุงูุชุญููู ูุญุฏุซ ุนูุฏ ุงูุญุงุฌุฉ ููุท

### 2. ุฅุถุงูุฉ ููู ุฌุฏูุฏุฉ:
ุนูุฏ ุฅุถุงูุฉ ููู ุฌุฏูุฏุฉ ููุณุชูู ุงูุชุฏูู:
1. ุฃุถู ุงููููุฉ ูู ููุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช
2. ุฃุถู ุงููููุฉ ูู ูููุฐุฌ ุงูุชุณุฌูู
3. ุฃุถู ุงููููุฉ ูู ุฏุงูุฉ `mapReligiosityLevel()`

### 3. ุงุฎุชุจุงุฑ ุดุงูู:
- ุงุฎุชุจุฑ ุฌููุน ุงูููู ุงููุฏุนููุฉ
- ุงุฎุชุจุฑ ุงูููู ุงููุงุฑุบุฉ
- ุงุฎุชุจุฑ ุงูููู ุบูุฑ ุงููุนุฑููุฉ

## ๐ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

ุงูุขู ุนูุฏ ุฅููุงู ุงูุชุณุฌูู:
1. โ **ูุชู ุชุญููู ุงูููู ุงููุฏููุฉ** ุชููุงุฆูุงู ููููู ุงูุฌุฏูุฏุฉ
2. โ **ูุชู ูุจูู ุฌููุน ุงูููู** ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
3. โ **ูุนูู ูุน ุงููุณุชุฎุฏููู ุงููุฏุงูู ูุงูุฌุฏุฏ** ุจุณูุงุณุฉ
4. โ **ุชุณุฌูู ุชุดุฎูุตู ุดุงูู** ูุชุชุจุน ุงูุนูููุงุช

## ๐ ุงูุฏุนู ุงูููู

ููุงุณุชูุณุงุฑุงุช ุญูู ูุฐุง ุงูุฅุตูุงุญ:
- **ุงูุจุฑูุฏ ุงูุฅููุชุฑููู**: contact@kareemamged.com
- **ุงูุชูุซูู**: ูููุงุช README ูู ุงููุดุฑูุน

---

**ุชู ุงูุฅุตูุงุญ ุจูุฌุงุญ - 16 ุณุจุชูุจุฑ 2025** โ
