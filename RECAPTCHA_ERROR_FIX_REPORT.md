# ุชูุฑูุฑ ุฅุตูุงุญ ุฎุทุฃ reCAPTCHA ูุฅุนุงุฏุฉ ุชุทุจูู ุงููุธุงู ุงููุชุฏุฑุฌ

## ๐ฏ ุงููุดููุฉ ุงูููุญุฏุฏุฉ

ูุงูุช ููุงู ูุดููุชุงู ุฑุฆูุณูุชุงู:

### 1. ุฎุทุฃ ูู ุชููุฆุฉ reCAPTCHA
```
โ ุฎุทุฃ ูู reCAPTCHA
โ ุฎุทุฃ ูู ุชููุฆุฉ reCAPTCHA: Error: reCAPTCHA has already been rendered in this element
```

### 2. ุฑุณุงูุฉ ุฎุงุทุฆุฉ ูู ูุญุฏุฉ ุงูุชุญูู
```
๐ ูุญุงููุฉ ุงุณุชุฎุฏุงู ุงูููุชุงุญ ุงูุชุฌุฑูุจู ุงูุจุฏูู...
```

ุฑุบู ุฃู ุงููุธุงู ูุงู ูุจุณุทุงู ููุง ูุณุชุฎุฏู ุงูููุชุงุญ ุงูุชุฌุฑูุจู.

## โ ุงูุญู ุงูููุทุจู

### 1. ุฅุนุงุฏุฉ ุชุทุจูู ุงููุธุงู ุงููุชุฏุฑุฌ
ุชู ุฅุนุงุฏุฉ ุชุทุจูู ุงููุธุงู ุงููุชุฏุฑุฌ ููุง ุทูุจ ุงููุณุชุฎุฏู:

#### ุงููุธุงู ุงูููุทุจู:
```
ุงูููุชุงุญ ุงูุญูููู โ ุงูููุชุงุญ ุงูุชุฌุฑูุจู โ ุงููููู ุงูุชูููุฏู
```

#### ุงูููุฏ ุงูููุทุจู:
```typescript
// ููุงุชูุญ reCAPTCHA ูุน ูุธุงู ูุชุฏุฑุฌ
const PRIMARY_SITE_KEY = '6LewINIrAAAAACzqj4aHviy5SlRiV5Q2HaAC0XKP'; // ุงูููุชุงุญ ุงูุญูููู
const FALLBACK_SITE_KEY = '6LeIxAcTAAAAAJcZVRqyHh71UMIEGNQ_MXjiZKhI'; // ุงูููุชุงุญ ุงูุชุฌุฑูุจู ุงูุจุฏูู

const [currentSiteKey, setCurrentSiteKey] = useState(PRIMARY_SITE_KEY);
const [keyErrors, setKeyErrors] = useState(0); // ุนุฏุงุฏ ุฃุฎุทุงุก ุงูููุงุชูุญ
```

### 2. ุฅุตูุงุญ ููุทู ุงูุฃุฎุทุงุก
ุชู ุฅุตูุงุญ ููุทู ุงูุชุนุงูู ูุน ุงูุฃุฎุทุงุก ูู ุฌููุน ุงูุฃูุงูู:

#### ูู script.onerror:
```typescript
// ุฅุฐุง ูุงู ููุงู ุฎุทุฃ ูู ุงูููุชุงุญ ุงูุญููููุ ุฌุฑุจ ุงูููุชุงุญ ุงูุจุฏูู
if (currentSiteKey === PRIMARY_SITE_KEY && newErrorCount === 1) {
  console.log('๐ ูุญุงููุฉ ุงุณุชุฎุฏุงู ุงูููุชุงุญ ุงูุชุฌุฑูุจู ุงูุจุฏูู...');
  setCurrentSiteKey(FALLBACK_SITE_KEY);
  setKeyErrors(0);
  setRecaptchaError(null);
  return;
}

// ุฅุฐุง ูุงู ููุงู ุฎุทุฃ ูู ุงูููุชุงุญ ุงูุจุฏูู ุฃูุถุงูุ ุงุณุชุฎุฏู ุงููููู ุงูุชูููุฏู
if (currentSiteKey === FALLBACK_SITE_KEY && newErrorCount >= 1) {
  console.log('๐ ุงุณุชุฎุฏุงู ุงููููู ุงูุชูููุฏู ูุงุญุชูุงุทู...');
  setRecaptchaError('ูุดู ูู ุชุญููู reCAPTCHA');
  setUseFallback(true);
  return;
}
```

#### ูู timeout:
```typescript
// ุฅุฐุง ูุงู ููุงู ุฎุทุฃ ูู ุงูููุชุงุญ ุงูุญููููุ ุฌุฑุจ ุงูููุชุงุญ ุงูุจุฏูู
if (currentSiteKey === PRIMARY_SITE_KEY && newErrorCount === 1) {
  console.log('๐ ูุญุงููุฉ ุงุณุชุฎุฏุงู ุงูููุชุงุญ ุงูุชุฌุฑูุจู ุงูุจุฏูู...');
  setCurrentSiteKey(FALLBACK_SITE_KEY);
  setKeyErrors(0);
  setRecaptchaError(null);
  return;
}

// ุฅุฐุง ูุงู ููุงู ุฎุทุฃ ูู ุงูููุชุงุญ ุงูุจุฏูู ุฃูุถุงูุ ุงุณุชุฎุฏู ุงููููู ุงูุชูููุฏู
if (currentSiteKey === FALLBACK_SITE_KEY && newErrorCount >= 1) {
  console.log('๐ ุงุณุชุฎุฏุงู ุงููููู ุงูุชูููุฏู ูุงุญุชูุงุทู...');
  setRecaptchaError('ุงูุชูุช ูููุฉ ุชุญููู reCAPTCHA');
  setUseFallback(true);
  return;
}
```

#### ูู error-callback:
```typescript
// ุฅุฐุง ูุงู ููุงู ุฎุทุฃ ูู ุงูููุชุงุญ ุงูุญููููุ ุฌุฑุจ ุงูููุชุงุญ ุงูุจุฏูู
if (currentSiteKey === PRIMARY_SITE_KEY && newErrorCount === 1) {
  console.log('๐ ูุญุงููุฉ ุงุณุชุฎุฏุงู ุงูููุชุงุญ ุงูุชุฌุฑูุจู ุงูุจุฏูู...');
  setCurrentSiteKey(FALLBACK_SITE_KEY);
  setKeyErrors(0); // ุฅุนุงุฏุฉ ุชุนููู ุนุฏุงุฏ ุงูุฃุฎุทุงุก
  setIsInitialized(false); // ุฅุนุงุฏุฉ ุชููุฆุฉ
  return;
}

// ุฅุฐุง ูุงู ููุงู ุฎุทุฃ ูู ุงูููุชุงุญ ุงูุจุฏูู ุฃูุถุงูุ ุงุณุชุฎุฏู ุงููููู ุงูุชูููุฏู
if (currentSiteKey === FALLBACK_SITE_KEY && newErrorCount >= 1) {
  console.log('๐ ุงุณุชุฎุฏุงู ุงููููู ุงูุชูููุฏู ูุงุญุชูุงุทู...');
  setUseFallback(true);
  return;
}
```

#### ูู catch:
```typescript
// ุฅุฐุง ูุงู ููุงู ุฎุทุฃ ูู ุงูููุชุงุญ ุงูุญููููุ ุฌุฑุจ ุงูููุชุงุญ ุงูุจุฏูู
if (currentSiteKey === PRIMARY_SITE_KEY && newErrorCount === 1) {
  console.log('๐ ูุญุงููุฉ ุงุณุชุฎุฏุงู ุงูููุชุงุญ ุงูุชุฌุฑูุจู ุงูุจุฏูู...');
  setCurrentSiteKey(FALLBACK_SITE_KEY);
  setKeyErrors(0);
  setRecaptchaError(null);
  setIsInitialized(false);
  return;
}

// ุฅุฐุง ูุงู ููุงู ุฎุทุฃ ูู ุงูููุชุงุญ ุงูุจุฏูู ุฃูุถุงูุ ุงุณุชุฎุฏู ุงููููู ุงูุชูููุฏู
if (currentSiteKey === FALLBACK_SITE_KEY && newErrorCount >= 1) {
  console.log('๐ ุงุณุชุฎุฏุงู ุงููููู ุงูุชูููุฏู ูุงุญุชูุงุทู...');
  setRecaptchaError('ุฎุทุฃ ูู ุชููุฆุฉ reCAPTCHA');
  setUseFallback(true);
  return;
}
```

### 3. ุฅุตูุงุญ ุฎุทุฃ "reCAPTCHA has already been rendered"
ุชู ุฅุถุงูุฉ ุชูุธูู ุฃูุถู ูุชุฌูุจ ุชููุฆุฉ ูุชุนุฏุฏุฉ:

```typescript
// ูุณุญ ูุญุชูู ุงูุนูุตุฑ ุฃููุงู ูุชุฌูุจ ุงูุชููุฆุฉ ุงููุชุนุฏุฏุฉ
if (recaptchaRef.current) {
  recaptchaRef.current.innerHTML = '';
}

// ุชูุธูู ุฃู widget ููุฌูุฏ ูุณุจูุงู
if (widgetIdRef.current !== null && window.grecaptcha) {
  try {
    window.grecaptcha.reset(widgetIdRef.current);
  } catch (e) {
    console.log('ุชู ุชูุธูู widget ุณุงุจู');
  }
  widgetIdRef.current = null;
}
```

### 4. ุชุญุฏูุซ ุฎุฏูุฉ reCAPTCHA
ุชู ุชุญุฏูุซ ุฎุฏูุฉ reCAPTCHA ูุชุณุชุฎุฏู ุงููุธุงู ุงููุชุฏุฑุฌ:

```typescript
// ููุงุชูุญ reCAPTCHA ูุน ูุธุงู ูุชุฏุฑุฌ
const PRIMARY_SECRET_KEY = '6LewINIrAAAAAFycWJU_h2A-8iIdMpa-axh17_O3'; // ุงูููุชุงุญ ุงูุญูููู
const FALLBACK_SECRET_KEY = '6LeIxAcTAAAAAGG-vFI1TnRWxMZNFuojJ4WifJWe'; // ุงูููุชุงุญ ุงูุชุฌุฑูุจู ุงูุจุฏูู

// ุงุณุชุฎุฏุงู ุงูููุชุงุญ ุงูุญูููู ูุงูุชุฑุงุถู
const RECAPTCHA_SECRET_KEY = PRIMARY_SECRET_KEY;
```

## ๐จ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

### ุงูุณููู ุงูุฌุฏูุฏ ุงูููุทุจู:
1. **ุงูููุชุงุญ ุงูุญูููู ูุนูู**: ูุธูุฑ reCAPTCHA ุจุดูู ุทุจูุนู
2. **ุงูููุชุงุญ ุงูุญูููู ููุดู**: ูุชู ุงูุชุจุฏูู ููููุชุงุญ ุงูุชุฌุฑูุจู
3. **ุงูููุชุงุญ ุงูุชุฌุฑูุจู ููุดู**: ูุชู ุงูุชุจุฏูู ูููููู ุงูุชูููุฏู

### ุงูุฑุณุงุฆู ุงููุชููุนุฉ ูู ูุญุฏุฉ ุงูุชุญูู:
```
โ ุชู ุชุญููู Google reCAPTCHA ุจูุฌุงุญ
โ ุชู ุชููุฆุฉ reCAPTCHA ุจูุฌุงุญุ Widget ID: [ุฑูู]
โ ุชู ุงูุชุญูู ูู reCAPTCHA: [token]
```

### ุนูุฏ ุญุฏูุซ ุฃุฎุทุงุก:
```
๐ ูุญุงููุฉ ุงุณุชุฎุฏุงู ุงูููุชุงุญ ุงูุชุฌุฑูุจู ุงูุจุฏูู...
๐ ุงุณุชุฎุฏุงู ุงููููู ุงูุชูููุฏู ูุงุญุชูุงุทู...
```

## ๐ ุงููููุงุช ุงูููุญุฏุซุฉ

### `src/components/RecaptchaComponent.tsx`:
- **ุฅุนุงุฏุฉ ุฅุถุงูุฉ**: `PRIMARY_SITE_KEY`, `FALLBACK_SITE_KEY`, `currentSiteKey`, `keyErrors`
- **ุฅุตูุงุญ**: ููุทู ุงูุชุนุงูู ูุน ุงูุฃุฎุทุงุก ูู ุฌููุน ุงูุฃูุงูู
- **ุฅุถุงูุฉ**: ุชูุธูู ุฃูุถู ูุชุฌูุจ ุชููุฆุฉ ูุชุนุฏุฏุฉ
- **ุชุญุฏูุซ**: dependencies ูุชุดูู ุงููุชุบูุฑุงุช ุงูุฌุฏูุฏุฉ

### `src/lib/recaptchaService.ts`:
- **ุฅุนุงุฏุฉ ุฅุถุงูุฉ**: `PRIMARY_SECRET_KEY`, `FALLBACK_SECRET_KEY`
- **ุชุญุฏูุซ**: ุงุณุชุฎุฏุงู ุงููุธุงู ุงููุชุฏุฑุฌ

## ๐งช ุงูุงุฎุชุจุงุฑ

### ููุชุญูู ูู ุงูุฅุตูุงุญ:
1. **ุงูุชุญ ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู**
2. **ุฑุงูุจ ูุญุฏุฉ ุงูุชุญูู ููุฑุณุงุฆู**
3. **ุชุญูู ูู ุนุฏู ุธููุฑ ุฎุทุฃ "reCAPTCHA has already been rendered"**
4. **ุงุฎุชุจุฑ ุงููุธุงู ุงููุชุฏุฑุฌ**:
   - ุฑุงูุจ ุงูุชุจุฏูู ุจูู ุงูููุงุชูุญ
   - ุชุญูู ูู ุงูุชุจุฏูู ูููููู ุงูุชูููุฏู ุนูุฏ ุงููุดู

### ุงููุชูุฌุฉ ุงููุชููุนุฉ:
- **ูุง ุชูุฌุฏ ุฃุฎุทุงุก ูู ุงูุชููุฆุฉ**
- **ุงููุธุงู ุงููุชุฏุฑุฌ ูุนูู ุจุดูู ุตุญูุญ**
- **ุงูุฑุณุงุฆู ูู ูุญุฏุฉ ุงูุชุญูู ุตุญูุญุฉ**

---

**ุชุงุฑูุฎ ุงูุฅุตูุงุญ**: 09-08-2025  
**ุงููุดููุฉ**: ุฎุทุฃ ูู ุชููุฆุฉ reCAPTCHA ูุฑุณุงูุฉ ุฎุงุทุฆุฉ  
**ุงูุญู**: ุฅุนุงุฏุฉ ุชุทุจูู ุงููุธุงู ุงููุชุฏุฑุฌ ูุน ุฅุตูุงุญ ุงูุฃุฎุทุงุก  
**ุงูุญุงูุฉ**: ููุชูู ูููุฎุชุจุฑ โ


