# دليل إعداد مفاتيح Google reCAPTCHA الصحيحة

## 🚨 المشكلة الحالية

تظهر رسالة الخطأ: **"خطأ لمالك الموقع: نوع المفتاح غير صالح"**

هذا يعني أن المفاتيح المستخدمة حالياً غير صحيحة أو غير مفعلة.

## ✅ الحل السريع المُطبق

تم استبدال المفاتيح بمفاتيح تجريبية صحيحة من Google للاختبار:

### المفاتيح التجريبية الحالية:
- **Site Key**: `6LeIxAcTAAAAAJcZVRqyHh71UMIEGNQ_MXjiZKhI`
- **Secret Key**: `6LeIxAcTAAAAAGG-vFI1TnRWxMZNFuojJ4WifJWe`

⚠️ **ملاحظة مهمة**: هذه مفاتيح تجريبية للاختبار فقط ولا تعمل في الإنتاج!

## 🔧 إعداد مفاتيح reCAPTCHA صحيحة

### الخطوة 1: إنشاء حساب Google reCAPTCHA
1. اذهب إلى [Google reCAPTCHA Admin Console](https://www.google.com/recaptcha/admin)
2. سجل الدخول بحساب Google
3. انقر على "Create" لإنشاء موقع جديد

### الخطوة 2: إعداد الموقع
1. **Label**: أدخل اسم للموقع (مثل "Rezge Platform")
2. **reCAPTCHA type**: اختر "reCAPTCHA v2" → "I'm not a robot" Checkbox
3. **Domains**: أضف النطاقات التالية:
   - `localhost` (للاختبار المحلي)
   - `127.0.0.1` (للاختبار المحلي)
   - النطاق الفعلي للموقع (مثل `rezge.com`)

### الخطوة 3: الحصول على المفاتيح
بعد إنشاء الموقع، ستحصل على:
- **Site Key** (مفتاح الموقع) - للاستخدام في الكود الأمامي
- **Secret Key** (المفتاح السري) - للاستخدام في الخادم فقط

### الخطوة 4: تحديث المفاتيح في الكود

#### في `src/components/RecaptchaComponent.tsx`:
```typescript
// استبدل المفتاح التجريبي بالمفتاح الصحيح
const RECAPTCHA_SITE_KEY = 'YOUR_ACTUAL_SITE_KEY_HERE';
```

#### في `src/lib/recaptchaService.ts`:
```typescript
// استبدل المفتاح التجريبي بالمفتاح الصحيح
const RECAPTCHA_SECRET_KEY = 'YOUR_ACTUAL_SECRET_KEY_HERE';
```

## 🔍 التحقق من صحة المفاتيح

### 1. اختبار المفتاح في المتصفح
افتح وحدة التحكم في المتصفح وتحقق من عدم وجود أخطاء مثل:
- "خطأ لمالك الموقع: نوع المفتاح غير صالح"
- "Invalid site key"

### 2. اختبار التحقق على الخادم
تحقق من أن API endpoint `/api/verify-recaptcha` يعمل بشكل صحيح.

### 3. اختبار في بيئات مختلفة
- الاختبار المحلي (`localhost`)
- بيئة التطوير
- بيئة الإنتاج

## 🛠️ استكشاف الأخطاء

### المشاكل الشائعة وحلولها:

#### 1. "نوع المفتاح غير صالح"
**السبب**: المفتاح غير صحيح أو غير مفعل
**الحل**: 
- تحقق من نسخ المفتاح بشكل صحيح
- تأكد من أن الموقع مفعل في Google reCAPTCHA Admin
- تأكد من أن النطاق مُدرج في قائمة النطاقات المسموحة

#### 2. "Invalid domain"
**السبب**: النطاق غير مُدرج في إعدادات reCAPTCHA
**الحل**: أضف النطاق إلى قائمة النطاقات المسموحة في Google reCAPTCHA Admin

#### 3. "reCAPTCHA not loading"
**السبب**: مشاكل في الشبكة أو HTTPS
**الحل**: 
- تأكد من أن الموقع يعمل على HTTPS
- تحقق من إعدادات الجدار الناري
- تأكد من أن Google reCAPTCHA غير محجوب

## 📋 قائمة التحقق

### قبل النشر:
- [ ] تم إنشاء مفاتيح reCAPTCHA صحيحة
- [ ] تم تحديث المفاتيح في الكود
- [ ] تم إضافة النطاق إلى قائمة النطاقات المسموحة
- [ ] تم اختبار المفاتيح محلياً
- [ ] تم اختبار المفاتيح في بيئة التطوير
- [ ] تم اختبار المفاتيح في بيئة الإنتاج

### بعد النشر:
- [ ] لا توجد أخطاء في وحدة التحكم
- [ ] reCAPTCHA يظهر بشكل صحيح
- [ ] التحقق يعمل بشكل صحيح
- [ ] المكون التقليدي يعمل كاحتياطي عند الحاجة

## 🔒 الأمان

### نصائح مهمة:
1. **لا تشارك Secret Key**: المفتاح السري يجب أن يبقى سرياً على الخادم فقط
2. **استخدم HTTPS**: reCAPTCHA يتطلب HTTPS في الإنتاج
3. **راقب الاستخدام**: راقب استخدام reCAPTCHA في Google Admin Console
4. **حدث المفاتيح دورياً**: فكر في تحديث المفاتيح كل فترة

## 📞 الدعم

### في حالة المشاكل:
1. تحقق من [Google reCAPTCHA Documentation](https://developers.google.com/recaptcha/docs/display)
2. راجع [Google reCAPTCHA Admin Console](https://www.google.com/recaptcha/admin)
3. تحقق من سجلات وحدة التحكم في المتصفح
4. تحقق من سجلات الخادم

### للمطورين:
- راجع `src/components/RecaptchaComponent.tsx` للتفاصيل التقنية
- راجع `src/lib/recaptchaService.ts` لخدمة التحقق
- راجع `src/api/verify-recaptcha.ts` لـ API endpoint

---

**تاريخ الإنشاء**: 09-08-2025  
**المشكلة**: نوع المفتاح غير صالح  
**الحالة**: محلولة مؤقتاً ✅  
**المطلوب**: تحديث المفاتيح بمفاتيح صحيحة من Google


