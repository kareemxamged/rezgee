@echo off
title ุฑุฒูู - ุชุดุบูู ุงููุดุฑูุน
color 0B

echo.
echo ================================================
echo ๐ ูุดุฑูุน ุฑุฒูู - ูููุน ุงูุฒูุงุฌ ุงูุฅุณูุงูู ๐
echo ================================================
echo.

REM ุงูุชุญูู ูู Node.js
echo [1/3] ๐ ุงูุชุญูู ูู Node.js...
node --version >nul 2>&1
if %errorlevel% neq 0 (
    echo โ Node.js ุบูุฑ ูุซุจุช!
    echo ๐ฅ ุชุญููู ูู: https://nodejs.org
    pause
    exit /b 1
)
echo โ Node.js ูุชููุฑ

REM ุชุซุจูุช ุงูููุชุจุงุช ุฅุฐุง ูู ุชูู ููุฌูุฏุฉ
echo [2/3] ๐ฆ ุงูุชุญูู ูู ุงูููุชุจุงุช...
if not exist "node_modules" (
    echo ๐ ุชุซุจูุช ุงูููุชุจุงุช...
    npm install
    if %errorlevel% neq 0 (
        echo โ ูุดู ูู ุชุซุจูุช ุงูููุชุจุงุช
        pause
        exit /b 1
    )
)
echo โ ุงูููุชุจุงุช ุฌุงูุฒุฉ

REM ุชูุธูู ุงูุจูุฑุชุงุช
echo [3/3] ๐งน ุชูุธูู ุงูุจูุฑุชุงุช...
for /f "tokens=5" %%a in ('netstat -ano ^| find "5173" ^| find "LISTENING"') do (
    taskkill /PID %%a /F >nul 2>&1
)
for /f "tokens=5" %%a in ('netstat -ano ^| find "3001" ^| find "LISTENING"') do (
    taskkill /PID %%a /F >nul 2>&1
)
echo โ ุงูุจูุฑุชุงุช ูุธููุฉ

echo.
echo ================================================
echo ๐ ุจุฏุก ุชุดุบูู ุงููุดุฑูุน
echo ================================================
echo ๐ฑ ุงูุชุทุจูู: http://localhost:5173
echo ๐ง ุฎุงุฏู SMTP: http://localhost:3001
echo ๐งช ุงุฎุชุจุงุฑ SMTP: test-independent-smtp.html
echo ================================================
echo.
echo ๐ก ูุตุงุฆุญ:
echo    โข ุงุณุชุฎุฏู "ูุณูุช ุงูุจุงุณููุฑุฏ" ูุงุฎุชุจุงุฑ ุงูุฅุฑุณุงู
echo    โข ุฑุงูุจ ูุฐู ุงููุงูุฐุฉ ูุฑุคูุฉ ุฑุณุงุฆู SMTP
echo    โข ูุฅููุงู ุงููุดุฑูุน: ุงุถุบุท Ctrl+C
echo.

REM ุชุดุบูู ุงููุดุฑูุน ูุน ุฎุงุฏู SMTP
npm run dev

echo.
echo ๐ ุชู ุฅููุงู ุงููุดุฑูุน
pause
