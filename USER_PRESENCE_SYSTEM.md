# ๐ข ูุธุงู ุญุงูุฉ ุงููุณุชุฎุฏููู ูุญุงูุฉ ุงููุชุงุจุฉ - ูููุน ุฑุฒูู

**ุชุงุฑูุฎ ุงูุชุทููุฑ:** 25-08-2025
**ุงููุทูุฑ:** Augment Agent
**ุงูุญุงูุฉ:** โ ููุชูู ููุฎุชุจุฑ
**ุขุฎุฑ ุชุญุฏูุซ:** 25-08-2025 - ุฅุถุงูุฉ ุงูููุทุฉ ุงูุฎุถุฑุงุก ูููุณุชุฎุฏููู ุงููุดุทูู

---

## ๐ฏ ูุธุฑุฉ ุนุงูุฉ

ุชู ุชุทููุฑ ูุธุงู ุดุงูู ูุชุชุจุน ุญุงูุฉ ุงููุณุชุฎุฏููู ูุญุงูุฉ ุงููุชุงุจุฉ ูู ุงููุญุงุฏุซุงุช ูููุฑ:

- **ุชุชุจุน ุขุฎุฑ ูุดุงุท ูููุณุชุฎุฏู** ูุน ุนุฑุถ "ูุดุท ุงูุขู" ุฃู "ูุดุท ููุฐ X ุฏูุงุฆู/ุณุงุนุงุช/ุฃูุงู"
- **ุญุงูุฉ ุงููุชุงุจุฉ ูู ุงูููุช ุงููุนูู** ูุน ุนุฑุถ "ููุชุจ ุงูุขู..." ูู ุฑุฃุณ ุงููุญุงุฏุซุฉ
- **ุญุงูุฉ ุงููุชุงุจุฉ ูู ูุงุฆูุฉ ุงููุญุงุฏุซุงุช** ูุน ุงุณุชุจุฏุงู ุขุฎุฑ ุฑุณุงูุฉ ุจู "ููุชุจ ุงูุขู..." ุนูุฏ ุงููุชุงุจุฉ
- **ุชุญุฏูุซ ุชููุงุฆู ููุญุงูุงุช** ูุน ุชูุธูู ุงูุญุงูุงุช ุงูููุชููุฉ ุงูุตูุงุญูุฉ
- **ุงูููุทุฉ ุงูุฎุถุฑุงุก ูููุณุชุฎุฏููู ุงููุดุทูู** ูุซู ุชุทุจูู ุงููุณูุฌุฑ

---

## ๐๏ธ ุชุญุฏูุซุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ๐ ุญููู ุฌุฏูุฏุฉ ูู ุฌุฏูู `users`:

```sql
-- ุญููู ุชุชุจุน ุญุงูุฉ ุงููุณุชุฎุฏู
last_seen_at TIMESTAMPTZ DEFAULT NOW()           -- ุขุฎุฑ ูุดุงุท ูููุณุชุฎุฏู
online_status VARCHAR(20) DEFAULT 'offline'      -- ุญุงูุฉ ุงูุงุชุตุงู (online/offline/away)
is_typing_in_conversation UUID                   -- ูุนุฑู ุงููุญุงุฏุซุฉ ุงูุชู ููุชุจ ูููุง ุงููุณุชุฎุฏู
```

### ๐ ุญููู ุฌุฏูุฏุฉ ูู ุฌุฏูู `conversations`:

```sql
-- ุญููู ุชุชุจุน ุญุงูุฉ ุงููุชุงุจุฉ
user1_typing BOOLEAN DEFAULT FALSE               -- ูู ุงููุณุชุฎุฏู ุงูุฃูู ููุชุจ
user2_typing BOOLEAN DEFAULT FALSE               -- ูู ุงููุณุชุฎุฏู ุงูุซุงูู ููุชุจ
user1_last_typing_at TIMESTAMPTZ                -- ุขุฎุฑ ููุช ูุชุงุจุฉ ูููุณุชุฎุฏู ุงูุฃูู
user2_last_typing_at TIMESTAMPTZ                -- ุขุฎุฑ ููุช ูุชุงุจุฉ ูููุณุชุฎุฏู ุงูุซุงูู
```

### ๐ง ุฏูุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ:

#### 1. `update_user_last_seen(user_id UUID)`
- ุชุญุฏูุซ ุขุฎุฑ ูุดุงุท ูููุณุชุฎุฏู
- ุชุนููู ุญุงูุฉ ุงูุงุชุตุงู ุฅูู 'online'

#### 2. `update_user_online_status(user_id UUID, status VARCHAR)`
- ุชุญุฏูุซ ุญุงูุฉ ุงูุงุชุตุงู ูููุณุชุฎุฏู
- ุชุญุฏูุซ ุขุฎุฑ ูุดุงุท ุนูุฏ ุงูุงูุชูุงู ุฅูู 'offline'

#### 3. `update_typing_status(conversation_id UUID, user_id UUID, is_typing BOOLEAN)`
- ุชุญุฏูุซ ุญุงูุฉ ุงููุชุงุจุฉ ูู ุงููุญุงุฏุซุฉ
- ุชุญุฏูุซ ุญุงูุฉ ุงููุณุชุฎุฏู ูู ุฌุฏูู ุงููุณุชุฎุฏููู

#### 4. `get_user_activity_status(user_id UUID)`
- ุงูุญุตูู ุนูู ุญุงูุฉ ูุดุงุท ุงููุณุชุฎุฏู
- ุฅุฑุฌุงุน ุงูุญุงูุฉ ูุนุฏุฏ ุงูุฏูุงุฆู ููุฐ ุขุฎุฑ ูุดุงุท

#### 5. `cleanup_expired_typing_status()`
- ุชูุธูู ุญุงูุงุช ุงููุชุงุจุฉ ุงูููุชููุฉ ุงูุตูุงุญูุฉ (ุฃูุซุฑ ูู ุฏูููุชูู)
- ุชุนูู ุชููุงุฆูุงู ูู ุฏูููุฉ ุนุจุฑ pg_cron

---

## ๐ง ุงูููููุงุช ุงูุชูููุฉ

### 1. ุฎุฏูุฉ ุฅุฏุงุฑุฉ ุญุงูุฉ ุงููุณุชุฎุฏููู

**ุงูููู:** `src/lib/userPresenceService.ts`

```typescript
class UserPresenceService {
  // ุจุฏุก ุชุชุจุน ุญุงูุฉ ุงููุณุชุฎุฏู
  async startPresenceTracking(userId: string): Promise<void>
  
  // ุฅููุงู ุชุชุจุน ุญุงูุฉ ุงููุณุชุฎุฏู
  async stopPresenceTracking(): Promise<void>
  
  // ุชุญุฏูุซ ุขุฎุฑ ูุดุงุท ูููุณุชุฎุฏู
  async updateUserLastSeen(userId: string): Promise<void>
  
  // ุชุญุฏูุซ ุญุงูุฉ ุงูุงุชุตุงู ูููุณุชุฎุฏู
  async updateUserOnlineStatus(userId: string, status: string): Promise<void>
  
  // ุงูุญุตูู ุนูู ุญุงูุฉ ูุดุงุท ุงููุณุชุฎุฏู
  async getUserPresenceStatus(userId: string): Promise<UserPresenceStatus | null>
  
  // ุชุญุฏูุซ ุญุงูุฉ ุงููุชุงุจุฉ ูู ุงููุญุงุฏุซุฉ
  async updateTypingStatus(conversationId: string, userId: string, isTyping: boolean): Promise<void>
  
  // ุชูุณูู ูุต ุญุงูุฉ ุงููุณุชุฎุฏู ููุนุฑุถ
  formatUserStatus(presence: UserPresenceStatus, t: Function): string
}
```

### 2. React Hooks ุงููุฎุตุตุฉ

**ุงูููู:** `src/hooks/useUserPresence.ts`

#### `useUserPresence()`
- ุจุฏุก ูุฅููุงู ุชุชุจุน ุญุงูุฉ ุงููุณุชุฎุฏู ุงูุญุงูู
- ุชุญุฏูุซ ุชููุงุฆู ูู 30 ุซุงููุฉ
- ูุนุงูุฌุฉ ุฃุญุฏุงุซ ุงููุงูุฐุฉ (beforeunload, visibilitychange)

#### `useUserStatus(userId: string)`
- ุงูุญุตูู ุนูู ุญุงูุฉ ูุณุชุฎุฏู ูุนูู
- ุชุญุฏูุซ ุชููุงุฆู ูู 30 ุซุงููุฉ
- ุฅุฑุฌุงุน ุงูุญุงูุฉ ูุญุงูุฉ ุงูุชุญููู

#### `useTypingStatus(conversationId: string)`
- ุฅุฏุงุฑุฉ ุญุงูุฉ ุงููุชุงุจุฉ ูู ุงููุญุงุฏุซุฉ
- ุงูุงุดุชุฑุงู ูู ุชุญุฏูุซุงุช ุงูููุช ุงููุนูู
- ุฅููุงู ุชููุงุฆู ุจุนุฏ 3 ุซูุงู ูู ุนุฏู ุงููุดุงุท

#### `useUserStatusText()`
- ุชูุณูู ูุต ุญุงูุฉ ุงููุณุชุฎุฏู ููุนุฑุถ
- ุฏุนู ุงูุชุฑุฌูุฉ ูุงูุชุนุฏุฏ ุงููุบูู

---

## ๐จ ุงูุชุญุฏูุซุงุช ูู ูุงุฌูุฉ ุงููุณุชุฎุฏู

### 1. ุฑุฃุณ ุงููุญุงุฏุซุฉ

**ูุจู ุงูุชุญุฏูุซ:**
```
ุฃุญูุฏ ูุญูุฏ โ
ุนุถู ูู ุงููููุน
```

**ุจุนุฏ ุงูุชุญุฏูุซ:**
```
ุฃุญูุฏ ูุญูุฏ โ
ูุดุท ุงูุขู                    // ุฃู "ูุดุท ููุฐ 5 ุฏูุงุฆู" ุฃู "ููุชุจ ุงูุขู..."
```

### 2. ูุงุฆูุฉ ุงููุญุงุฏุซุงุช

**ูุจู ุงูุชุญุฏูุซ:**
```
ุฃุญูุฏ ูุญูุฏ
ุฃูุช: ูุฑุญุจุงู ููู ุญุงููุ
ููุฐ 10 ุฏูุงุฆู
```

**ุจุนุฏ ุงูุชุญุฏูุซ (ุนูุฏ ุงููุชุงุจุฉ):**
```
ุฃุญูุฏ ูุญูุฏ
ููุชุจ ุงูุขู...              // ูุญู ูุญู ุขุฎุฑ ุฑุณุงูุฉ ุนูุฏ ุงููุชุงุจุฉ
ููุฐ 10 ุฏูุงุฆู
```

### 3. ูุนุงูุฌุฉ ุฃุญุฏุงุซ ุงููุชุงุจุฉ

- **ุจุฏุก ุงููุชุงุจุฉ:** ุนูุฏ ูุชุงุจุฉ ุฃู ูุต ูู ุญูู ุงูุฑุณุงูุฉ
- **ุฅููุงู ุงููุชุงุจุฉ:** ุนูุฏ ูุณุญ ุงููุต ุฃู ุนุฏู ุงููุชุงุจุฉ ููุฏุฉ 3 ุซูุงู
- **ุฅููุงู ููุฑู:** ุนูุฏ ุฅุฑุณุงู ุงูุฑุณุงูุฉ

### 4. ุงูููุทุฉ ุงูุฎุถุฑุงุก ูููุณุชุฎุฏููู ุงููุดุทูู

**ุงููุตู:** ููุทุฉ ุฎุถุฑุงุก ุตุบูุฑุฉ ุชุธูุฑ ุฃุนูู ุงูุตูุฑุฉ ุงูุดุฎุตูุฉ ูููุณุชุฎุฏููู ุงููุดุทูู ุญุงููุงูุ ูุซู ุชุทุจูู ุงููุณูุฌุฑ.

**ุงูููุงูุน:**
- **ูุงุฆูุฉ ุงููุญุงุฏุซุงุช:** ููุทุฉ ุฎุถุฑุงุก ุฃุนูู ูููู ุงูุฃูุงุชุงุฑ ููู ูุณุชุฎุฏู ูุดุท
- **ุฑุฃุณ ุงููุญุงุฏุซุฉ:** ููุทุฉ ุฎุถุฑุงุก ุฃุนูู ูููู ุฃูุงุชุงุฑ ุงููุณุชุฎุฏู ุงููุดุท

**ุงูููุงุตูุงุช ุงูุชูููุฉ:**
- **ุงูุญุฌู:** 3 ุฃุญุฌุงู ูุฎุชููุฉ (sm, md, lg)
- **ุงูุชุฃุซูุฑุงุช:** ูุจุถ ุฃุฎุถุฑ ูุน ููุฌ ุฎููู
- **ุงูุชุญุฏูุซ:** ูู 30 ุซุงููุฉ ูุน ุจุงูู ุญุงูุงุช ุงููุณุชุฎุฏููู
- **ุงูุดุฑุท:** ูุธูุฑ ููุท ุนูุฏูุง `isOnline = true` (ูุดุท ุฎูุงู ุขุฎุฑ 5 ุฏูุงุฆู)

**ุงููููุงุช ุงูุฌุฏูุฏุฉ:**
- `src/components/OnlineStatusIndicator.tsx` - ูููู ุงูููุทุฉ ุงูุฎุถุฑุงุก
- `src/components/OnlineStatusIndicator.css` - ุชุฃุซูุฑุงุช CSS ุงููุฎุตุตุฉ
- `src/hooks/useUserPresence.ts` - ุฅุถุงูุฉ `useMultipleUserStatus` hook

---

## ๐ ุงููุตูุต ูุงูุชุฑุฌูุฉ

### ุงููุตูุต ุงูุนุฑุจูุฉ (`src/locales/ar.json`):

```json
"userStatus": {
  "online": "ูุดุท ุงูุขู",
  "justNow": "ูุดุท ููุฐ ูุญุธุงุช",
  "minutesAgo": "ูุดุท ููุฐ {{count}} ุฏูููุฉ",
  "minutesAgo_plural": "ูุดุท ููุฐ {{count}} ุฏูุงุฆู",
  "hoursAgo": "ูุดุท ููุฐ {{count}} ุณุงุนุฉ",
  "hoursAgo_plural": "ูุดุท ููุฐ {{count}} ุณุงุนุงุช",
  "daysAgo": "ูุดุท ููุฐ {{count}} ููู",
  "daysAgo_plural": "ูุดุท ููุฐ {{count}} ุฃูุงู",
  "typing": "ููุชุจ ุงูุขู..."
}
```

### ุงููุตูุต ุงูุฅูุฌููุฒูุฉ (`src/locales/en.json`):

```json
"userStatus": {
  "online": "Active now",
  "justNow": "Active moments ago",
  "minutesAgo": "Active {{count}} minute ago",
  "minutesAgo_plural": "Active {{count}} minutes ago",
  "hoursAgo": "Active {{count}} hour ago",
  "hoursAgo_plural": "Active {{count}} hours ago",
  "daysAgo": "Active {{count}} day ago",
  "daysAgo_plural": "Active {{count}} days ago",
  "typing": "Typing now..."
}
```

---

## โก ุงูุฃุฏุงุก ูุงูุชุญุณููุงุช

### 1. ุชุญุฏูุซ ุชููุงุฆู ุฐูู
- **Heartbeat ูู 30 ุซุงููุฉ** ูุชุญุฏูุซ ุขุฎุฑ ูุดุงุท
- **ุชูุธูู ุชููุงุฆู ูู ุฏูููุฉ** ููุญุงูุงุช ุงูููุชููุฉ ุงูุตูุงุญูุฉ
- **Real-time subscriptions** ูุชุญุฏูุซุงุช ููุฑูุฉ

### 2. ุฅุฏุงุฑุฉ ุงูุฐุงูุฑุฉ
- **ุชูุธูู Timeouts** ุนูุฏ ุฅูุบุงุก ุงูุชุญููู
- **ุฅูุบุงุก ุงูุงุดุชุฑุงูุงุช** ุนูุฏ ุชุบููุฑ ุงููุญุงุฏุซุฉ
- **ุชุญุฏูุซ ูุญูู ููุญุงูุฉ** ูุชุฌูุจ ุงูุทูุจุงุช ุบูุฑ ุงูุถุฑูุฑูุฉ

### 3. ููุงุฑุณ ูุงุนุฏุฉ ุงูุจูุงูุงุช
```sql
-- ููุงุฑุณ ูุชุญุณูู ุงูุฃุฏุงุก
CREATE INDEX idx_users_last_seen_at ON users(last_seen_at);
CREATE INDEX idx_users_online_status ON users(online_status);
CREATE INDEX idx_users_typing_conversation ON users(is_typing_in_conversation);
CREATE INDEX idx_conversations_user1_typing ON conversations(user1_typing) WHERE user1_typing = TRUE;
CREATE INDEX idx_conversations_user2_typing ON conversations(user2_typing) WHERE user2_typing = TRUE;
```

---

## ๐งช ููููุฉ ุงูุงุฎุชุจุงุฑ

### 1. ุงุฎุชุจุงุฑ ุญุงูุฉ ุงููุณุชุฎุฏู:
1. **ุณุฌู ุฏุฎูู ุจุญุณุงุจูู ูุฎุชูููู** ูู ูุชุตูุญูู ูููุตููู
2. **ุงุจุฏุฃ ูุญุงุฏุซุฉ** ุจูู ุงูุญุณุงุจูู
3. **ูุงุญุธ ุนุฑุถ "ูุดุท ุงูุขู"** ูู ุฑุฃุณ ุงููุญุงุฏุซุฉ
4. **ุฃุบูู ุฃุญุฏ ุงููุชุตูุญูู** ููุงุญุธ ุชุบููุฑ ุงูุญุงูุฉ ุฅูู "ูุดุท ููุฐ X ุฏูุงุฆู"

### 2. ุงุฎุชุจุงุฑ ุญุงูุฉ ุงููุชุงุจุฉ:
1. **ุงุจุฏุฃ ุงููุชุงุจุฉ** ูู ุญูู ุงูุฑุณุงูุฉ
2. **ูุงุญุธ ุธููุฑ "ููุชุจ ุงูุขู..."** ูู ุฑุฃุณ ุงููุญุงุฏุซุฉ ูููุณุชุฎุฏู ุงูุขุฎุฑ
3. **ูุงุญุธ ุธููุฑ "ููุชุจ ุงูุขู..."** ูู ูุงุฆูุฉ ุงููุญุงุฏุซุงุช
4. **ุชููู ุนู ุงููุชุงุจุฉ** ููุงุญุธ ุงุฎุชูุงุก ุงูุญุงูุฉ ุจุนุฏ 3 ุซูุงู

### 3. ุงุฎุชุจุงุฑ ุงูุชูุธูู ุงูุชููุงุฆู:
1. **ุงุจุฏุฃ ุงููุชุงุจุฉ ุซู ุฃุบูู ุงููุชุตูุญ ูุฌุฃุฉ**
2. **ุงูุชุธุฑ ุฏูููุชูู**
3. **ุชุญูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช** - ูุฌุจ ุฃู ุชููู ุญุงูุฉ ุงููุชุงุจุฉ FALSE

---

## ๐ ุงูุฅุญุตุงุฆูุงุช

- โ **5 ุฏูุงู ุฌุฏูุฏุฉ** ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ **7 ุญููู ุฌุฏูุฏุฉ** ูู ุงูุฌุฏุงูู
- โ **1 ุฎุฏูุฉ ุดุงููุฉ** ูุฅุฏุงุฑุฉ ุงูุญุงูุงุช
- โ **5 hooks ูุฎุตุตุฉ** ููุชูุงูู ูุน React (ุฅุถุงูุฉ useMultipleUserStatus)
- โ **1 ูููู ุฌุฏูุฏ** ููููุทุฉ ุงูุฎุถุฑุงุก (OnlineStatusIndicator)
- โ **16 ูุต ุฌุฏูุฏ** ููุชุฑุฌูุฉ (ุนุฑุจู + ุฅูุฌููุฒู)
- โ **ุชุญุฏูุซ ุชููุงุฆู ูู 30 ุซุงููุฉ** ูุขุฎุฑ ูุดุงุท
- โ **ุชูุธูู ุชููุงุฆู ูู ุฏูููุฉ** ููุญุงูุงุช ุงูููุชููุฉ ุงูุตูุงุญูุฉ
- โ **ููุทุฉ ุฎุถุฑุงุก ุชูุงุนููุฉ** ูุน ุชุฃุซูุฑุงุช CSS ูุชูุฏูุฉ

---

## ๐ง ุงููุดุงูู ุงูุชู ุชู ุญููุง

### โ ูุดููุฉ ูุนุงููุงุช ุงูุฏูุงู (ุชู ุงูุญู)

**ุงููุดููุฉ:**
```
Error: Could not find the function public.update_user_online_status(status, user_id) in the schema cache
```

**ุงูุณุจุจ:** ูุงู ููุงู ุชุถุงุฑุจ ูู ุฃุณูุงุก ูุนุงููุงุช ุงูุฏุงูุฉ ุจูู ุงูุชุนุฑูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุงูุงุณุชุฏุนุงุก ูู ุงูููุฏ.

**ุงูุญู:**
- ุชู ุชุญุฏูุซ ุงุณุชุฏุนุงุก ุงูุฏุงูุฉ ูุงุณุชุฎุฏุงู `new_status` ุจุฏูุงู ูู `status`
- ุชู ุงูุชุฃูุฏ ูู ุชุทุงุจู ุฃุณูุงุก ุงููุนุงููุงุช ูู ุฌููุน ุงูุฏูุงู

**ุงูููุฏ ุงููุญุฏุซ:**
```typescript
const { error } = await supabase.rpc('update_user_online_status', {
  user_id: userId,
  new_status: status  // ุชู ุชุบููุฑ ูู 'status' ุฅูู 'new_status'
});
```

### โ ูุดููุฉ ูุธุงู ุงูุญุธุฑ - ุฃุฎุทุงุก 406 (ุชู ุงูุญู)

**ุงููุดููุฉ:**
```
GET https://...supabase.co/rest/v1/user_blocks?... 406 (Not Acceptable)
```

**ุงูุณุจุจ:** ุณูุงุณุงุช Row Level Security (RLS) ุชููุน ุงููุณุชุฎุฏู ูู ุฑุคูุฉ ุณุฌูุงุช ุงูุญุธุฑ ุนุจุฑ ุงูุงุณุชุนูุงูุงุช ุงููุจุงุดุฑุฉ.

**ุงูุญู:**
- ุฅูุดุงุก ุฏูุงู ุขููุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุน `SECURITY DEFINER`
- ุงุณุชุจุฏุงู ุงูุงุณุชุนูุงูุงุช ุงููุจุงุดุฑุฉ ุจุงูุฏูุงู ุงูุขููุฉ
- ุฅุตูุงุญ ุชุถุงุฑุจ ุฃุณูุงุก ุงููุนุงููุงุช ูู ุงูุฏูุงู

**ุงูุฏูุงู ุงูุฌุฏูุฏุฉ:**
```sql
-- ุงูุชุญูู ูู ูุฌูุฏ ุญุธุฑ ูุดุท
check_active_block(p_blocker_user_id, p_blocked_user_id)

-- ุญุธุฑ ูุณุชุฎุฏู ุจุดูู ุขูู
safe_block_user(p_blocker_user_id, p_blocked_user_id, p_conversation_id, p_block_type)

-- ุฅูุบุงุก ุญุธุฑ ูุณุชุฎุฏู ุจุดูู ุขูู
safe_unblock_user(p_blocker_user_id, p_blocked_user_id)
```

### โ ูุดููุฉ ุชุฑุชูุจ ุชุนุฑูู ุงูุฏูุงู (ุชู ุงูุญู)

**ุงููุดููุฉ:**
```
ReferenceError: Cannot access 'getOtherUser' before initialization
```

**ุงูุณุจุจ:** ูุงู ูุชู ุงุณุชุฎุฏุงู ุฏุงูุฉ `getOtherUser` ูู hooks ูุจู ุชุนุฑูููุง ูู ุงูููุฏ.

**ุงูุญู:**
- ุชู ููู ุชุนุฑูู ุงูุฏุงูุฉ ุฅูู ุฃุนูู ุจุงุณุชุฎุฏุงู `useCallback`
- ุชู ุญุฐู ุงูุชุนุฑูู ุงูููุฑุฑ ููุฏุงูุฉ
- ุชู ุฅุถุงูุฉ `useCallback` ุฅูู ุงููุงุฑุฏุงุช

**ุงูููุฏ ุงููุญุฏุซ:**
```typescript
// Get the other user in the conversation (moved up to avoid hoisting issues)
const getOtherUser = useCallback((conversation: Conversation | null) => {
  if (!userProfile?.id || !conversation) return null;
  return conversation.user1_id === userProfile.id ? conversation.user2 : conversation.user1;
}, [userProfile?.id]);
```

---

๐ **ูุธุงู ุญุงูุฉ ุงููุณุชุฎุฏููู ูุญุงูุฉ ุงููุชุงุจุฉ ุฌุงูุฒ ููุนูู ุจููุงุกุฉ ุนุงููุฉ ูุน ุชุฌุฑุจุฉ ูุณุชุฎุฏู ูุญุณูุฉ!**
