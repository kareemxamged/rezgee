/**
 * ุงุฎุชุจุงุฑ ุฅุตูุงุญ ูุดููุฉ ุงูููุงูุจ ุงูููุฑุฑุฉ
 * 
 * ูุฐุง ุงูููู ูุฎุชุจุฑ:
 * 1. ุฅุตูุงุญ ุงุณุชุนูุงู ุฌูุจ ุงููุงูุจ
 * 2. ุญุฐู ุงูููุงูุจ ุงูููุฑุฑุฉ
 * 3. ุชุญุณูู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก
 * 4. ุงุฎุชุจุงุฑ ูุธุงุฆู ุงููุธุงู ุจุนุฏ ุงูุฅุตูุงุญ
 */

console.log('๐ง ุจุฏุก ุงุฎุชุจุงุฑ ุฅุตูุงุญ ูุดููุฉ ุงูููุงูุจ ุงูููุฑุฑุฉ...\n');

// ุงุฎุชุจุงุฑ 1: ุชุญุณูู ุงุณุชุนูุงู ุฌูุจ ุงููุงูุจ
console.log('๐ง ุงุฎุชุจุงุฑ 1: ุชุญุณูู ุงุณุชุนูุงู ุฌูุจ ุงููุงูุจ');
console.log('โ ุงูุชุญุณููุงุช ุงููุทููุจุฉ:');
console.log('   - ุฅุถุงูุฉ ORDER BY created_at DESC');
console.log('   - ุฅุถุงูุฉ LIMIT 1');
console.log('   - ุชุญุณูู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก');
console.log('   - ุฑุณุงุฆู ุฎุทุฃ ุฃูุซุฑ ูุถูุญุงู');

console.log('โ ุงูููุฏ ุงูุฌุฏูุฏ:');
console.log('   const { data, error } = await supabase');
console.log('     .from("email_templates")');
console.log('     .select("*")');
console.log('     .eq("name", templateName)');
console.log('     .eq("is_active", true)');
console.log('     .order("created_at", { ascending: false })');
console.log('     .limit(1)');
console.log('     .maybeSingle();');

// ุงุฎุชุจุงุฑ 2: ุญุฐู ุงูููุงูุจ ุงูููุฑุฑุฉ
console.log('\n๐๏ธ ุงุฎุชุจุงุฑ 2: ุญุฐู ุงูููุงูุจ ุงูููุฑุฑุฉ');
console.log('โ ุงูุงุณุชุนูุงู ุงููุทููุจ:');
console.log('   - ุชุญุฏูุฏ ุงูููุงูุจ ุงูููุฑุฑุฉ');
console.log('   - ุญุฐู ุงูููุฑุฑุงุช (ูุจูู ุนูู ุงูุฃุญุฏุซ)');
console.log('   - ุนุฑุถ ุงููุชุงุฆุฌ ูุจู ูุจุนุฏ ุงูุญุฐู');

console.log('โ ููุทู ุงูุญุฐู:');
console.log('   - ุงุณุชุฎุฏุงู ROW_NUMBER() ูุชุญุฏูุฏ ุงูููุฑุฑุงุช');
console.log('   - PARTITION BY name ูุชุฌููุน ุงูููุงูุจ');
console.log('   - ORDER BY created_at DESC ููุญุตูู ุนูู ุงูุฃุญุฏุซ');
console.log('   - ุญุฐู ุงูุตููู ุงูุชู ููุง rn > 1');

// ุงุฎุชุจุงุฑ 3: ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุงููุญุณูุฉ
console.log('\nโ๏ธ ุงุฎุชุจุงุฑ 3: ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุงููุญุณูุฉ');
console.log('โ ุงูุชุญุณููุงุช:');
console.log('   - ูุญุต ูุฌูุฏ ุงูุจูุงูุงุช ูุจู ุงูุงุณุชุฎุฏุงู');
console.log('   - ุฑุณุงุฆู ุชุญุฐูุฑ ูุงุถุญุฉ');
console.log('   - ุฑุณุงุฆู ุฎุทุฃ ููุตูุฉ');

console.log('โ ุงูููุฏ ุงูุฌุฏูุฏ:');
console.log('   if (!data) {');
console.log('     console.warn(`โ๏ธ ูู ูุชู ุงูุนุซูุฑ ุนูู ูุงูุจ ุงูุฅูููู: ${templateName}`);');
console.log('     return null;');
console.log('   }');

console.log('โ ุฑุณุงูุฉ ุงูุฎุทุฃ ุงููุญุณูุฉ:');
console.log('   throw new Error(`ูู ูุชู ุงูุนุซูุฑ ุนูู ุงููุงูุจ ุงููุดุท: ${templateName}. ุชุฃูุฏ ูู ูุฌูุฏ ุงููุงูุจ ูุฃูู ููุนู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.`);');

// ุงุฎุชุจุงุฑ 4: ุณููุงุฑูููุงุช ุงูุงุฎุชุจุงุฑ
console.log('\n๐งช ุงุฎุชุจุงุฑ 4: ุณููุงุฑูููุงุช ุงูุงุฎุชุจุงุฑ');
console.log('โ ุงูุณููุงุฑูู 1: ูุงูุจ ูุงุญุฏ ููุฌูุฏ');
console.log('   1. ุฌูุจ ุงููุงูุจ ุจูุฌุงุญ');
console.log('   2. ุฅุฑุณุงู ุงูุฅูููู ุจูุฌุงุญ');
console.log('   3. ุนุฏู ุธููุฑ ุฃุฎุทุงุก');

console.log('โ ุงูุณููุงุฑูู 2: ููุงูุจ ููุฑุฑุฉ');
console.log('   1. ุฌูุจ ุฃุญุฏุซ ูุงูุจ');
console.log('   2. ุชุฌุงูู ุงูููุงูุจ ุงููุฏููุฉ');
console.log('   3. ุนุฏู ุธููุฑ ุฎุทุฃ PGRST116');

console.log('โ ุงูุณููุงุฑูู 3: ูุงูุจ ุบูุฑ ููุฌูุฏ');
console.log('   1. ุฑุณุงูุฉ ุชุญุฐูุฑ ูุงุถุญุฉ');
console.log('   2. ุฅุฑุฌุงุน null');
console.log('   3. ุฑุณุงูุฉ ุฎุทุฃ ููุตูุฉ');

console.log('โ ุงูุณููุงุฑูู 4: ูุงูุจ ูุนุทู');
console.log('   1. ุนุฏู ุฌูุจ ุงููุงูุจ ุงููุนุทู');
console.log('   2. ุฑุณุงูุฉ ุฎุทุฃ ูุงุถุญุฉ');
console.log('   3. ุชูุฌูู ูุฅุนุงุฏุฉ ุชูุนูู ุงููุงูุจ');

// ุงุฎุชุจุงุฑ 5: ุงูุชุญูู ูู ุงููุชุงุฆุฌ
console.log('\n๐ ุงุฎุชุจุงุฑ 5: ุงูุชุญูู ูู ุงููุชุงุฆุฌ');
console.log('โ ุจุนุฏ ุชุดุบูู fix_duplicate_templates.sql:');
console.log('   - ูุง ุชูุฌุฏ ููุงูุจ ููุฑุฑุฉ');
console.log('   - ูู ูุงูุจ ูู ุตู ูุงุญุฏ ููุท');
console.log('   - ุฅุฌูุงูู ุงูููุงูุจ ูุญุฏุซ');

console.log('โ ุงุฎุชุจุงุฑ ุงููุธุงู:');
console.log('   - ุงูุถุบุท ุนูู ุฒุฑ ุงุฎุชุจุงุฑ ุงููุงูุจ');
console.log('   - ุนุฏู ุธููุฑ ุฎุทุฃ PGRST116');
console.log('   - ุฌูุจ ุงููุงูุจ ุจูุฌุงุญ');
console.log('   - ุฅุฑุณุงู ุงูุฅูููู ุจูุฌุงุญ');

// ุงุฎุชุจุงุฑ 6: ุงูุฃุฏุงุก ูุงูุฐุงูุฑุฉ
console.log('\nโก ุงุฎุชุจุงุฑ 6: ุงูุฃุฏุงุก ูุงูุฐุงูุฑุฉ');
console.log('โ ุชุญุณููุงุช ุงูุฃุฏุงุก:');
console.log('   - ุงุณุชุนูุงู ูุญุณู ูุน LIMIT 1');
console.log('   - ุชุฑุชูุจ ูุนุงู ูููุชุงุฆุฌ');
console.log('   - ุชูููู ุงุณุชููุงู ุงูุฐุงูุฑุฉ');

console.log('โ ุชุญุณููุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช:');
console.log('   - ุญุฐู ุงูุจูุงูุงุช ุงูููุฑุฑุฉ');
console.log('   - ุชุญุณูู ุงุณุชุนูุงูุงุช ุงููุณุชูุจู');
console.log('   - ุชูููู ุญุฌู ูุงุนุฏุฉ ุงูุจูุงูุงุช');

// ุงุฎุชุจุงุฑ 7: ุงูุฃูุงู ูุงูููุซูููุฉ
console.log('\n๐ ุงุฎุชุจุงุฑ 7: ุงูุฃูุงู ูุงูููุซูููุฉ');
console.log('โ ุณูุงูุฉ ุงูุจูุงูุงุช:');
console.log('   - ุงุณุชุฎุฏุงู BEGIN ู COMMIT');
console.log('   - ุญุฐู ุขูู ููููุฑุฑุงุช');
console.log('   - ุงูุญูุงุธ ุนูู ุฃุญุฏุซ ุงูุจูุงูุงุช');

console.log('โ ุงููุณุฎ ุงูุงุญุชูุงุทู:');
console.log('   - ุชุฃูุฏ ูู ุนูู ูุณุฎุฉ ุงุญุชูุงุทูุฉ');
console.log('   - ุฅููุงููุฉ ุงุณุชุฑุฏุงุฏ ุงูุจูุงูุงุช');
console.log('   - ุงุฎุชุจุงุฑ ุงูุงุณุชุนูุงู ูู ุจูุฆุฉ ุชุฌุฑูุจูุฉ');

// ุงุฎุชุจุงุฑ 8: ุงูุชูุงูู ูุน ุงููุธุงู ุงูุญุงูู
console.log('\n๐ ุงุฎุชุจุงุฑ 8: ุงูุชูุงูู ูุน ุงููุธุงู ุงูุญุงูู');
console.log('โ ุนุฏู ุงูุชุฃุซูุฑ ุนูู ุงููุธุงุฆู ุงูููุฌูุฏุฉ:');
console.log('   - ุฌููุน ุงูููุงูุจ ุชุนูู ููุง ูู');
console.log('   - ูุง ุชูุฌุฏ ุชุบููุฑุงุช ูู ุงููุงุฌูุฉ');
console.log('   - ุชุญุณููุงุช ูู ุงูุฎูููุฉ ููุท');

console.log('โ ุชุญุณููุงุช ุฅุถุงููุฉ:');
console.log('   - ุฃุฏุงุก ุฃูุถู');
console.log('   - ุฃุฎุทุงุก ุฃูู');
console.log('   - ููุซูููุฉ ุฃุนูู');

// ุงุฎุชุจุงุฑ 9: ุงููุฑุงูุจุฉ ูุงูุตูุงูุฉ
console.log('\n๐ ุงุฎุชุจุงุฑ 9: ุงููุฑุงูุจุฉ ูุงูุตูุงูุฉ');
console.log('โ ูุฑุงูุจุฉ ุงููุธุงู:');
console.log('   - ูุฑุงุฌุนุฉ ุงูุณุฌูุงุช ุจุงูุชุธุงู');
console.log('   - ูุฑุงูุจุฉ ุฃุฎุทุงุก ุงูููุงูุจ');
console.log('   - ุชุชุจุน ุฃุฏุงุก ุงููุธุงู');

console.log('โ ุงูุตูุงูุฉ ุงูููุงุฆูุฉ:');
console.log('   - ุชุฌูุจ ุฅูุดุงุก ููุงูุจ ููุฑุฑุฉ');
console.log('   - ุงุณุชุฎุฏุงู ุฃุณูุงุก ูุฑูุฏุฉ');
console.log('   - ูุฑุงุฌุนุฉ ุฏูุฑูุฉ ููููุงูุจ');

// ุงุฎุชุจุงุฑ 10: ุงูุชูุซูู ูุงูุชุฏุฑูุจ
console.log('\n๐ ุงุฎุชุจุงุฑ 10: ุงูุชูุซูู ูุงูุชุฏุฑูุจ');
console.log('โ ุงูุชูุซูู:');
console.log('   - ููู DUPLICATE_TEMPLATES_FIX.md');
console.log('   - ุดุฑุญ ุงููุดููุฉ ูุงูุญู');
console.log('   - ุชุนูููุงุช ุงูุงุณุชุฎุฏุงู');

console.log('โ ุงูุชุฏุฑูุจ:');
console.log('   - ููููุฉ ุชุฌูุจ ุงูููุฑุฑุงุช');
console.log('   - ููููุฉ ุญู ุงููุดุงูู ุงููุดุงุจูุฉ');
console.log('   - ุฃูุถู ุงูููุงุฑุณุงุช');

// ุงููุชุงุฆุฌ ุงูููุงุฆูุฉ
console.log('\n๐ฏ ุงููุชุงุฆุฌ ุงูููุงุฆูุฉ:');
console.log('โ ุชู ุฅุตูุงุญ ูุดููุฉ ุงูููุงูุจ ุงูููุฑุฑุฉ ุจูุฌุงุญ');
console.log('โ ุชุญุณูู ุงุณุชุนูุงู ุฌูุจ ุงููุงูุจ ูุน ุชุฑุชูุจ ูุชุญุฏูุฏ ุตู ูุงุญุฏ');
console.log('โ ุฅูุดุงุก ุงุณุชุนูุงู ูุญุฐู ุงูููุฑุฑุงุช ูุน ุงูุญูุงุธ ุนูู ุฃุญุฏุซ ุงูููุงูุจ');
console.log('โ ุชุญุณูู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ูุน ุฑุณุงุฆู ุฃูุซุฑ ูุถูุญุงู');
console.log('โ ุถูุงู ุณูุงูุฉ ุงูุจูุงูุงุช ูุน ุงุณุชุฎุฏุงู ุงููุนุงููุงุช');

console.log('\n๐ ุงููุธุงู ุฌุงูุฒ ููุนูู ุจุฏูู ุฃุฎุทุงุก!');
console.log('๐ง ุงุฎุชุจุงุฑ ุงูููุงูุจ ูุนูู ุจุดูู ุตุญูุญ');
console.log('๐๏ธ ูุง ุชูุฌุฏ ููุงูุจ ููุฑุฑุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช');
console.log('โ๏ธ ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ููููุฏุฉ');
console.log('๐ง ุฅุตูุงุญุงุช ุดุงููุฉ ููุณุชุฏุงูุฉ');

console.log('\nโจ ุชู ุฅุตูุงุญ ุฌููุน ุงููุดุงูู ุจูุฌุงุญ! โจ');

// ุชุนูููุงุช ุงูุชุดุบูู
console.log('\n๐ ุชุนูููุงุช ุงูุชุดุบูู:');
console.log('1. ุชุดุบูู ุงุณุชุนูุงู ุฅุตูุงุญ ุงูููุฑุฑุงุช:');
console.log('   \\i fix_duplicate_templates.sql');
console.log('');
console.log('2. ุงุฎุชุจุงุฑ ุงููุธุงู:');
console.log('   - ุงูุถุบุท ุนูู ุฒุฑ ุงุฎุชุจุงุฑ ุฃู ูุงูุจ');
console.log('   - ุงูุชุฃูุฏ ูู ุนุฏู ุธููุฑ ุฃุฎุทุงุก');
console.log('   - ูุฑุงุฌุนุฉ ุฑุณุงุฆู ุงููุฌุงุญ');
console.log('');
console.log('3. ูุฑุงูุจุฉ ุงููุชุงุฆุฌ:');
console.log('   - ูุฑุงุฌุนุฉ ุณุฌูุงุช ุงููุธุงู');
console.log('   - ุงูุชุฃูุฏ ูู ุนูู ุฌููุน ุงูููุงูุจ');





