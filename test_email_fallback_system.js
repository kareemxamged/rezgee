// ุงุฎุชุจุงุฑ ูุธุงู ุงููุณุฎ ุงูุงุญุชูุงุทู ููุฅููููุงุช
// Test Email Fallback System

console.log('๐ง ุงุฎุชุจุงุฑ ูุธุงู ุงููุณุฎ ุงูุงุญุชูุงุทู ููุฅููููุงุช...\n');

// ูุญุงูุงุฉ ุงููุธุงู ุงูุฌุฏูุฏ ูุน ุงูุฃุฎุทุงุก
const DynamicLanguageEmailService = {
  sendEmail: async (emailData) => {
    console.log('๐ง DynamicLanguageEmailService: ุจุฏุก ุฅุฑุณุงู ุงูุฅูููู...');
    console.log(`๐ฌ ุฅูู: ${emailData.to}`);
    console.log(`๐ ููุน ุงููุงูุจ: ${emailData.templateType}`);

    // ูุญุงูุงุฉ ุฎุทุฃ ูู ุงููุธุงู ุงูุฌุฏูุฏ
    const shouldFail = Math.random() < 0.3; // 30% ุงุญุชูุงู ูุดู
    
    if (shouldFail) {
      console.error('โ ูุดู ุงููุธุงู ุงูุฏููุงูููู: ุฎุทุฃ ูุญุงูู');
      throw new Error('ูุดู ุงููุธุงู ุงูุฏููุงูููู');
    }

    // ูุญุงูุงุฉ ูุฌุงุญ ุงููุธุงู ุงูุฌุฏูุฏ
    console.log('โ ุชู ุฅุฑุณุงู ุงูุฅูููู ุจูุฌุงุญ ุจุงุณุชุฎุฏุงู ุงููุธุงู ุงูุฏููุงูููู');
    return { success: true, language: 'ar' };
  }
};

// ูุญุงูุงุฉ ุงููุธุงู ุงูุชูููุฏู
const TraditionalEmailService = {
  sendEmail: async (email, subject, message) => {
    console.log('๐ง ุงุณุชุฎุฏุงู ุงููุธุงู ุงูุชูููุฏู ููุณุฎ ุงุญุชูุงุทู...');
    
    // ูุญุงูุงุฉ ุฅุฑุณุงู ุนุจุฑ ุงูุฎุงุฏู ุงููุณุชูู
    try {
      console.log('๐ ูุญุงููุฉ ุฅุฑุณุงู ุนุจุฑ ุงูุฎุงุฏู ุงููุณุชูู...');
      
      // ูุญุงูุงุฉ ูุฌุงุญ ุงูุฎุงุฏู ุงููุณุชูู
      const serverSuccess = Math.random() < 0.8; // 80% ูุฌุงุญ
      
      if (serverSuccess) {
        console.log('โ ุชู ุฅุฑุณุงู ุงูููุฏ ุนุจุฑ ุงูุฎุงุฏู ุงููุณุชูู (ุงููุธุงู ุงูุชูููุฏู)');
        return { success: true };
      } else {
        throw new Error('ูุดู ุงูุฎุงุฏู ุงููุณุชูู');
      }
    } catch (error) {
      console.warn('โ๏ธ ูุดู ุงูุฎุงุฏู ุงููุณุชูู:', error.message);
      
      // ูุญุงูุงุฉ ุงููุณุฎ ุงูุงุญุชูุงุทู ุงูุฃุฎูุฑ
      console.log('๐ ูุญุงููุฉ ุงููุณุฎ ุงูุงุญุชูุงุทู ุงูุฃุฎูุฑ...');
      const fallbackSuccess = Math.random() < 0.9; // 90% ูุฌุงุญ
      
      if (fallbackSuccess) {
        console.log('โ ุชู ุฅุฑุณุงู ุงูุฅูููู ุนุจุฑ ุงููุณุฎ ุงูุงุญุชูุงุทู');
        return { success: true };
      } else {
        console.error('โ ูุดู ุฌููุน ุทุฑู ุงูุฅุฑุณุงู');
        return { success: false, error: 'ูุดู ูู ุฅุฑุณุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู' };
      }
    }
  }
};

// ูุญุงูุงุฉ ุฎุฏูุฉ ุงูุชุญูู ุงูุซูุงุฆู ูุน ุงููุณุฎ ุงูุงุญุชูุงุทู
const UserTwoFactorService = {
  sendVerificationEmail: async (email, code, type) => {
    try {
      console.log('๐ง ุฅุฑุณุงู ุฅูููู ุงูุชุญูู ุจุงุณุชุฎุฏุงู ุงููุธุงู ุงูุฏููุงูููู...');
      console.log(`๐ฌ ุฅูู: ${email}`);
      console.log(`๐ ููุน ุงูุชุญูู: ${type}`);

      // ูุญุงููุฉ ุงุณุชุฎุฏุงู ุงููุธุงู ุงูุฌุฏูุฏ ุฃููุงู
      try {
        const result = await DynamicLanguageEmailService.sendEmail({
          to: email,
          templateType: 'two_factor_login',
          data: { code, firstName: 'ุงููุณุชุฎุฏู' }
        });

        if (result.success) {
          console.log('โ ุชู ุฅุฑุณุงู ุฅูููู ุงูุชุญูู ุจูุฌุงุญ ุจุงุณุชุฎุฏุงู ุงููุธุงู ุงูุฏููุงูููู');
          return { success: true };
        } else {
          throw new Error(result.error || 'ูุดู ุงููุธุงู ุงูุฏููุงูููู');
        }

      } catch (dynamicError) {
        console.warn('โ๏ธ ูุดู ุงููุธุงู ุงูุฏููุงููููุ ุงุณุชุฎุฏุงู ุงููุธุงู ุงูุชูููุฏู...', dynamicError.message);
        
        // ุงุณุชุฎุฏุงู ุงููุธุงู ุงูุชูููุฏู ููุณุฎ ุงุญุชูุงุทู
        return await UserTwoFactorService.sendVerificationEmailFallback(email, code, type);
      }

    } catch (error) {
      console.error('โ ุฎุทุฃ ุนุงู ูู ุฅุฑุณุงู ุฅูููู ุงูุชุญูู:', error);
      return { success: false, error: 'ุญุฏุซ ุฎุทุฃ ูู ุฅุฑุณุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู' };
    }
  },

  sendVerificationEmailFallback: async (email, code, type) => {
    try {
      console.log('๐ง ุงุณุชุฎุฏุงู ุงููุธุงู ุงูุชูููุฏู ููุณุฎ ุงุญุชูุงุทู...');
      
      // ุชุญุฏูุฏ ููุน ุงูุฑุณุงูุฉ ุจูุงุกู ุนูู ุงูููุน
      let subject = '';
      let message = '';

      switch (type) {
        case 'login':
          subject = 'ููุฏ ุชุณุฌูู ุงูุฏุฎูู - ุฑุฒูู';
          message = `ููุฏ ุงูุชุญูู: ${code}`;
          break;
        case 'device_trust':
          subject = 'ููุฏ ุชูุนูู ุงูุฌูุงุฒ ุงูููุซูู - ุฑุฒูู';
          message = `ููุฏ ุงูุชุญูู: ${code}`;
          break;
        case 'password_reset':
          subject = 'ููุฏ ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ - ุฑุฒูู';
          message = `ููุฏ ุงูุชุญูู: ${code}`;
          break;
        default:
          subject = 'ููุฏ ุงูุชุญูู - ุฑุฒูู';
          message = `ููุฏ ุงูุชุญูู: ${code}`;
      }

      // ุงุณุชุฎุฏุงู ุงููุธุงู ุงูุชูููุฏู
      return await TraditionalEmailService.sendEmail(email, subject, message);

    } catch (error) {
      console.error('โ Error in send verification email fallback:', error);
      return { success: false, error: 'ุญุฏุซ ุฎุทุฃ ูู ุฅุฑุณุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู' };
    }
  }
};

console.log('๐งช ุงุฎุชุจุงุฑ ุณููุงุฑูููุงุช ูุฎุชููุฉ:\n');

// ุงุฎุชุจุงุฑ ุณููุงุฑูููุงุช ูุฎุชููุฉ
const testScenarios = [
  {
    name: 'ุงููุธุงู ุงูุฌุฏูุฏ ูุนูู ุจูุฌุงุญ',
    description: 'ุงููุธุงู ุงูุฏููุงูููู ูุนูู ุจุฏูู ุฃุฎุทุงุก',
    shouldFail: false
  },
  {
    name: 'ุงููุธุงู ุงูุฌุฏูุฏ ููุดูุ ุงูุชูููุฏู ููุฌุญ',
    description: 'ุงููุธุงู ุงูุฏููุงูููู ููุดูุ ุงููุธุงู ุงูุชูููุฏู ููุฌุญ',
    shouldFail: true
  },
  {
    name: 'ุงููุธุงู ุงูุฌุฏูุฏ ููุดูุ ุงูุชูููุฏู ููุดูุ ุงููุณุฎ ุงูุงุญุชูุงุทู ููุฌุญ',
    description: 'ุฌููุน ุงูุฃูุธูุฉ ุชูุดูุ ุงููุณุฎ ุงูุงุญุชูุงุทู ุงูุฃุฎูุฑ ููุฌุญ',
    shouldFail: true
  },
  {
    name: 'ุฌููุน ุงูุฃูุธูุฉ ุชูุดู',
    description: 'ุฌููุน ุทุฑู ุงูุฅุฑุณุงู ุชูุดู',
    shouldFail: true
  }
];

// ุชุดุบูู ุงูุงุฎุชุจุงุฑุงุช
testScenarios.forEach(async (scenario, index) => {
  console.log(`\n${index + 1}. ุงุฎุชุจุงุฑ: ${scenario.name}`);
  console.log(`   ุงููุตู: ${scenario.description}`);
  console.log('='.repeat(60));
  
  try {
    const result = await UserTwoFactorService.sendVerificationEmail(
      'test@example.com',
      '123456',
      'login'
    );
    
    if (result.success) {
      console.log('โ ูุฌุญ ุงูุงุฎุชุจุงุฑ - ุชู ุฅุฑุณุงู ุงูุฅูููู ุจูุฌุงุญ');
    } else {
      console.log('โ ูุดู ุงูุงุฎุชุจุงุฑ - ูู ูุชู ุฅุฑุณุงู ุงูุฅูููู');
      console.log(`   ุงูุณุจุจ: ${result.error}`);
    }
  } catch (error) {
    console.log('โ ุฎุทุฃ ูู ุงูุงุฎุชุจุงุฑ:', error.message);
  }
});

console.log('\n' + '='.repeat(80) + '\n');

// ููุฒุงุช ูุธุงู ุงููุณุฎ ุงูุงุญุชูุงุทู
console.log('๐ก๏ธ ููุฒุงุช ูุธุงู ุงููุณุฎ ุงูุงุญุชูุงุทู:\n');

const fallbackFeatures = [
  'ูุญุงููุฉ ุงููุธุงู ุงูุฌุฏูุฏ ุฃููุงู',
  'ุงูุงูุชูุงู ูููุธุงู ุงูุชูููุฏู ุนูุฏ ุงููุดู',
  'ูุนุงูุฌุฉ ุดุงููุฉ ููุฃุฎุทุงุก',
  'ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ููููุฏุฉ',
  'ุชุณุฌูู ููุตู ูุฌููุน ุงูุนูููุงุช',
  'ุถูุงู ุงุณุชูุฑุงุฑูุฉ ุงูุฎุฏูุฉ',
  'ุณูููุฉ ุงูุตูุงูุฉ ูุงูุชุทููุฑ',
  'ูุฑููุฉ ูู ุฅุถุงูุฉ ุทุฑู ุฅุฑุณุงู ุฌุฏูุฏุฉ'
];

fallbackFeatures.forEach((feature, index) => {
  console.log(`${index + 1}. ${feature}`);
});

console.log('\n' + '='.repeat(80) + '\n');

// ูุณุชููุงุช ุงููุณุฎ ุงูุงุญุชูุงุทู
console.log('๐ ูุณุชููุงุช ุงููุณุฎ ุงูุงุญุชูุงุทู:\n');

const fallbackLevels = [
  {
    level: 1,
    name: 'ุงููุธุงู ุงูุฏููุงูููู ุงูุฌุฏูุฏ',
    description: 'ูุดู ุงููุบุฉ ุงูุชููุงุฆู + ููุงูุจ ุฏููุงููููุฉ',
    successRate: '70%',
    features: ['ูุดู ุงููุบุฉ ุงูุชููุงุฆู', 'ููุงูุจ ุฏููุงููููุฉ', 'ุฏุนู ุงูุนุฑุจูุฉ ูุงูุฅูุฌููุฒูุฉ']
  },
  {
    level: 2,
    name: 'ุงููุธุงู ุงูุชูููุฏู',
    description: 'ููุงูุจ ุซุงุจุชุฉ ุจุงููุบุฉ ุงูุนุฑุจูุฉ',
    successRate: '80%',
    features: ['ููุงูุจ ุซุงุจุชุฉ', 'ูุบุฉ ุนุฑุจูุฉ', 'ุฎุงุฏู ูุณุชูู']
  },
  {
    level: 3,
    name: 'ุงููุณุฎ ุงูุงุญุชูุงุทู ุงูุฃุฎูุฑ',
    description: 'ุทุฑููุฉ ุฅุฑุณุงู ุจุฏููุฉ',
    successRate: '90%',
    features: ['ุทุฑููุฉ ุจุฏููุฉ', 'ุฅุฑุณุงู ูุจุงุดุฑ', 'ุถูุงู ุงูุงุณุชูุฑุงุฑูุฉ']
  }
];

fallbackLevels.forEach((level, index) => {
  console.log(`${index + 1}. ุงููุณุชูู ${level.level}: ${level.name}`);
  console.log(`   ุงููุตู: ${level.description}`);
  console.log(`   ูุนุฏู ุงููุฌุงุญ: ${level.successRate}`);
  console.log('   ุงูููุฒุงุช:');
  level.features.forEach(feature => {
    console.log(`     โ ${feature}`);
  });
  console.log('');
});

console.log('='.repeat(80) + '\n');

// ููุงุฆุฏ ูุธุงู ุงููุณุฎ ุงูุงุญุชูุงุทู
console.log('๐ฏ ููุงุฆุฏ ูุธุงู ุงููุณุฎ ุงูุงุญุชูุงุทู:\n');

const benefits = [
  'ุถูุงู ุงุณุชูุฑุงุฑูุฉ ุงูุฎุฏูุฉ ุญุชู ุนูุฏ ูุดู ุงููุธุงู ุงูุฌุฏูุฏ',
  'ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุณูุณุฉ ุจุฏูู ุงููุทุงุน',
  'ูุฑููุฉ ูู ุงูุชุทููุฑ ูุงูุงุฎุชุจุงุฑ',
  'ุณูููุฉ ุฅุถุงูุฉ ููุฒุงุช ุฌุฏูุฏุฉ',
  'ูุนุงูุฌุฉ ุดุงููุฉ ููุฃุฎุทุงุก',
  'ุชุณุฌูู ููุตู ูุฌููุน ุงูุนูููุงุช',
  'ุฅููุงููุฉ ุงูุชุญุณูู ุงููุณุชูุฑ',
  'ุฏุนู ุฃูุถู ูููุณุชุฎุฏููู'
];

benefits.forEach((benefit, index) => {
  console.log(`${index + 1}. ${benefit}`);
});

console.log('\n' + '='.repeat(80) + '\n');

// ุณููุงุฑูููุงุช ุงูุงุณุชุฎุฏุงู
console.log('๐ ุณููุงุฑูููุงุช ุงูุงุณุชุฎุฏุงู:\n');

const usageScenarios = [
  {
    scenario: 'ุงููุณุชุฎุฏู ุงูุนุงุฏู',
    description: 'ุงููุธุงู ุงูุฌุฏูุฏ ูุนูู ุจุดูู ุทุจูุนู',
    experience: 'ุชุฌุฑุจุฉ ููุชุงุฒุฉ ูุน ูุดู ุงููุบุฉ ุงูุชููุงุฆู'
  },
  {
    scenario: 'ูุดููุฉ ูู ุงููุธุงู ุงูุฌุฏูุฏ',
    description: 'ุงููุธุงู ุงูุฌุฏูุฏ ููุงุฌู ูุดููุฉ ุชูููุฉ',
    experience: 'ุงูุชูุงู ุณูุณ ูููุธุงู ุงูุชูููุฏู ุจุฏูู ุงููุทุงุน'
  },
  {
    scenario: 'ูุดุงูู ูู ุงูุจููุฉ ุงูุชุญุชูุฉ',
    description: 'ูุดุงูู ูู ุงูุฎูุงุฏู ุฃู ุงูุดุจูุฉ',
    experience: 'ุงุณุชุฎุฏุงู ุงููุณุฎ ุงูุงุญุชูุงุทู ุงูุฃุฎูุฑ ูุถูุงู ุงูุงุณุชูุฑุงุฑูุฉ'
  },
  {
    scenario: 'ุงุฎุชุจุงุฑ ุงููุธุงู ุงูุฌุฏูุฏ',
    description: 'ุงุฎุชุจุงุฑ ุงููุธุงู ุงูุฌุฏูุฏ ูู ุจูุฆุฉ ุงูุฅูุชุงุฌ',
    experience: 'ุฅููุงููุฉ ุงูุงุฎุชุจุงุฑ ุงูุขูู ูุน ุงููุณุฎ ุงูุงุญุชูุงุทู'
  }
];

usageScenarios.forEach((scenario, index) => {
  console.log(`${index + 1}. ${scenario.scenario}:`);
  console.log(`   ุงููุตู: ${scenario.description}`);
  console.log(`   ุงูุชุฌุฑุจุฉ: ${scenario.experience}`);
  console.log('');
});

console.log('='.repeat(80) + '\n');

// ุงูุชูุตูุงุช
console.log('๐ก ุงูุชูุตูุงุช:\n');

const recommendations = [
  'ูุฑุงูุจุฉ ูุนุฏู ูุฌุงุญ ูู ูุณุชูู ูู ูุณุชููุงุช ุงููุณุฎ ุงูุงุญุชูุงุทู',
  'ุชุญุณูู ุงููุธุงู ุงูุฌุฏูุฏ ุจูุงุกู ุนูู ุงูุฃุฎุทุงุก ุงููุณุฌูุฉ',
  'ุฅุถุงูุฉ ุงููุฒูุฏ ูู ุทุฑู ุงููุณุฎ ุงูุงุญุชูุงุทู ุฅุฐุง ูุฒู ุงูุฃูุฑ',
  'ุชุทููุฑ ูุธุงู ุชูุจููุงุช ููุฃุฎุทุงุก ุงููุชูุฑุฑุฉ',
  'ุฅูุดุงุก ููุญุฉ ุชุญูู ููุฑุงูุจุฉ ุฃุฏุงุก ุงููุธุงู',
  'ุชูุซูู ุฌููุน ุณููุงุฑูููุงุช ุงููุดู ูุงููุฌุงุญ',
  'ุฅุฌุฑุงุก ุงุฎุชุจุงุฑุงุช ุฏูุฑูุฉ ูุฌููุน ุงููุณุชููุงุช',
  'ุชุทููุฑ ูุธุงู ุฅุญุตุงุฆูุงุช ููุตู'
];

recommendations.forEach((recommendation, index) => {
  console.log(`${index + 1}. ${recommendation}`);
});

console.log('\n' + '='.repeat(80) + '\n');

console.log('๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ:');
console.log('1. ุงุฎุชุจุงุฑ ุงููุธุงู ูู ุจูุฆุฉ ุงูุชุทููุฑ');
console.log('2. ูุฑุงูุจุฉ ุฃุฏุงุก ุงููุธุงู ุงูุฌุฏูุฏ');
console.log('3. ุชุญุณูู ุงููุธุงู ุจูุงุกู ุนูู ุงูุฃุฎุทุงุก');
console.log('4. ุฅุถุงูุฉ ุงููุฒูุฏ ูู ุทุฑู ุงููุณุฎ ุงูุงุญุชูุงุทู');
console.log('5. ุชุทููุฑ ูุธุงู ูุฑุงูุจุฉ ุดุงูู');
console.log('6. ุฅุฌุฑุงุก ุงุฎุชุจุงุฑุงุช ุฏูุฑูุฉ');

console.log('\nโจ ูุธุงู ุงููุณุฎ ุงูุงุญุชูุงุทู ููุชูู ูุฌุงูุฒ ููุงุณุชุฎุฏุงู!');
console.log('๐ก๏ธ ุถูุงู ุงุณุชูุฑุงุฑูุฉ ุงูุฎุฏูุฉ');
console.log('๐ ุงูุชูุงู ุณูุณ ุจูู ุงูุฃูุธูุฉ');
console.log('๐ ูุฑุงูุจุฉ ุดุงููุฉ ููุฃุฏุงุก');
console.log('๐ ุชุทููุฑ ูุณุชูุฑ ูุชุญุณูู');


